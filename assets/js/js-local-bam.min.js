function ZStream(){}function Inflate(){this.was=[0]}function InfBlocks(z,checkfn,w){this.hufts=new Int32Array(3*MANY),this.window=new Uint8Array(w),this.end=w,this.checkfn=checkfn,this.mode=IB_TYPE,this.reset(z,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new InfCodes,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new InfTree}function InfCodes(){}function InfTree(){}function inflate_trees_fixed(bl,bd,tl,td,z){return bl[0]=fixed_bl,bd[0]=fixed_bd,tl[0]=fixed_tl,td[0]=fixed_td,Z_OK}function arrayCopy(src,srcOffset,dest,destOffset,count){if(0!=count){if(!src)throw"Undef src";if(!dest)throw"Undef dest";jsaDbg=src.subarray(srcOffset,srcOffset+count),jsaDest=dest,jsaDestoffset=destOffset,0==srcOffset&&count==src.length?arrayCopy_fast(src,dest,destOffset):hasSubarray?arrayCopy_fast(src.subarray(srcOffset,srcOffset+count),dest,destOffset):1==src.BYTES_PER_ELEMENT&&count>100?arrayCopy_fast(new Uint8Array(src.buffer,src.byteOffset+srcOffset,count),dest,destOffset):arrayCopy_slow(src,srcOffset,dest,destOffset,count)}}function arrayCopy_slow(src,srcOffset,dest,destOffset,count){for(var i=0;count>i;++i)dest[destOffset+i]=src[srcOffset+i]}function arrayCopy_fast(src,dest,destOffset){dest.set(src,destOffset)}function adler32(adler,buf,index,len){if(null==buf)return 1;for(var k,s1=65535&adler,s2=adler>>16&65535;len>0;){for(k=ADLER_NMAX>len?len:ADLER_NMAX,len-=k;k>=16;)s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,s1+=255&buf[index++],s2+=s1,k-=16;if(0!=k)do s1+=255&buf[index++],s2+=s1;while(0!=--k);s1%=ADLER_BASE,s2%=ADLER_BASE}return s2<<16|s1}function jszlib_inflate_buffer(buffer,start,length,afterUncOffset){buffer=start?new Uint8Array(buffer,start,length):new Uint8Array(buffer);var z=new ZStream;z.inflateInit(DEF_WBITS,!0),z.next_in=buffer,z.next_in_index=0,z.avail_in=buffer.length;for(var oBlockList=[],totalSize=0;;){var obuf=new Uint8Array(32e3);z.next_out=obuf,z.next_out_index=0,z.avail_out=obuf.length;var status=z.inflate(Z_NO_FLUSH);if(status!=Z_OK&&status!=Z_STREAM_END&&status!=Z_BUF_ERROR)throw z.msg;if(0!=z.avail_out){var newob=new Uint8Array(obuf.length-z.avail_out);arrayCopy(obuf,0,newob,0,obuf.length-z.avail_out),obuf=newob}if(oBlockList.push(obuf),totalSize+=obuf.length,status==Z_STREAM_END||status==Z_BUF_ERROR)break}if(afterUncOffset&&(afterUncOffset[0]=(start||0)+z.next_in_index),1==oBlockList.length)return oBlockList[0].buffer;for(var out=new Uint8Array(totalSize),cursor=0,i=0;i<oBlockList.length;++i){var b=oBlockList[i];arrayCopy(b,0,out,cursor,b.length),cursor+=b.length}return out.buffer}function bin2Ranges(indexReader,ref,binid){for(var res=[],bs=indexReader.idxContent.indexseq[ref].binseq,cnkseq=bs[indexReader.bhash[ref][binid]].chunkseq,i=0;i<cnkseq.length;i++){var cnk=cnkseq[i],cnkBeg=cnk.cnk_beg.valueOf(),cnkEnd=cnk.cnk_end.valueOf();res.push([[rshift16(cnkBeg),low16(cnkBeg)],[rshift16(cnkEnd),low16(cnkEnd)]])}return res}function rngBeg(rng){return rng[0]}function rngEnd(rng){return rng[1]}function rngComp(rv1,rv2){return rv1[0]==rv2[0]?rv1[1]-rv2[1]:rv1[0]-rv2[0]}function rngLess(lrv,rrv){return rngComp(lrv,rrv)<0}function rngEql(lrv,rrv){return 0==rngComp(lrv,rrv)}function rngGtr(lrv,rrv){return rngComp(lrv,rrv)>0}function bin2Beg(indexReader,ref,binid){var range=bin2Ranges(indexReader,ref,binid);return range[0]}function bin2End(indexReader,ref,binid){var range=bin2Ranges(indexReader,ref,binid);return range[range.length-1]}function ensureOrderedRngs(sortedcnks){for(var newcnks=[],i=1;i<sortedcnks.length;i++)if(rngGtr(rngEnd(sortedcnks[i-1]),rngBeg(sortedcnks[i]))){if(!rngGtr(rngEnd(sortedcnks[i-1]),rngEnd(sortedcnks[i]))){var ncnk=sortedcnks[i-1];ncnk[1]=rngBeg(sortedcnks[i]),newcnks.push(ncnk)}}else newcnks.push(sortedcnks[i-1]);return newcnks.push(sortedcnks[sortedcnks.length-1]),newcnks.filter(function(c){return void 0!=c})}function getChunks(indexReader,ref,beg,end){var bids=reg2bins(beg,end+1).filter(function(x){return void 0!=indexReader.bhash[ref][x]},indexReader);bids=bids.filter(function(b){return b>=start16kbBinid&&end16kbBinid>=b});var bcnks=bids.map(function(x){return bin2Ranges(indexReader,ref,x)},indexReader),cnks=bcnks.reduce(function(V,ranges){return ranges.forEach(function(item){V.push(item)}),V},[]);return sortedcnks=cnks.sort(function(l,r){return l[0][0]==r[0][0]?l[0][1]-r[0][1]:l[0][0]-r[0][0]}),ensureOrderedRngs(sortedcnks)}function makeuid(a){return a?(a^16*Math.random()>>a/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,makeuid)}function log2(x){return Math.log(x)/Math.LN2}function simpleHash(items,key){var itemhash={},i=0;for(var o in items){var x=items[o][key];itemhash[x]=i,i+=1}return itemhash}function cstg(index,buf){for(var s="",i=index;i<buf.length&&0!=buf[i];)s+=String.fromCharCode(buf[i]),i++;return[i<buf.length?i+1:i,s]}function _wrapperCB(ctxThis,file,b,ebsz,fmt,x1,x2,cb){var buf=new Uint8Array(b),p=new jParser(buf,fmt);p.curBuf=buf,p.endBlkSz=ebsz,p.theFile=file,p.offset=p.tell(),p.curFileOffset=x1,p.nxtFileOffset=x2,cb.call(ctxThis,p)}function wrappedJParser(file,start,fmt,cb){inflateBlock(file,start,function(b,ebsz){nextBlockOffset(file,start,function(x1){nextBlockOffset(file,x1,function(x2){_wrapperCB(this,file,b,ebsz,fmt,x1,x2,cb)})})})}function wrappedRegionJParser(file,beg,end,fmt,cb){beg>=end?wrappedJParser(file,beg,fmt,cb):inflateRegion(file,beg,end,function(b,ebsz){nextBlockOffset(file,end,function(x2){_wrapperCB(this,file,b,ebsz,fmt,end,x2,cb)})})}function nextParseRes(p,parse_rule,cb){try{p.offset=p.tell(),cb.call(this,p.parse(parse_rule))}catch(e){if(!(e instanceof RangeError))throw e;inflateBlock(p.theFile,p.curFileOffset,function(b){nextBlockOffset(p.theFile,p.nxtFileOffset,function(x){p.curBuf=appendBuffer(p.curBuf,new Uint8Array(b),!0),p.view.buffer=p.curBuf.buffer,p.view.byteLength=p.view.buffer.byteLength,p.view._view=new DataView(p.view.buffer,0,p.view.byteLength),p.curFileOffset=p.nxtFileOffset,p.nxtFileOffset=x,p.seek(p.offset),nextParseRes(p,parse_rule,cb)})})}}function rshift16(val){return Math.floor(val/Math.pow(2,16))}function low16(val){return 65535&val}function bin2Recs(binid){var k=binid,l=Math.floor(log2(7*k+1)/3),sl=Math.pow(2,29-3*l),ol=(Math.pow(2,3*l)-1)/7,interval=[(k-ol)*sl,(k-ol+1)*sl-1];return[interval,k,l,sl,ol]}function reg2bin(beg,end){return--end,beg>>14==end>>14?4681+(beg>>14):beg>>17==end>>17?585+(beg>>17):beg>>20==end>>20?73+(beg>>20):beg>>23==end>>23?9+(beg>>23):beg>>26==end>>26?1+(beg>>26):0}function reg2bins(beg,end){var k,list=[];for(--end,list.push(0),k=1+(beg>>26);1+(end>>26)>=k;++k)list.push(k);for(k=9+(beg>>23);9+(end>>23)>=k;++k)list.push(k);for(k=73+(beg>>20);73+(end>>20)>=k;++k)list.push(k);for(k=585+(beg>>17);585+(end>>17)>=k;++k)list.push(k);for(k=4681+(beg>>14);4681+(end>>14)>=k;++k)list.push(k);return list}function _spred(l,r){return r>l?-1:l>r?1:0}function estimateRefCoverageDepth(refIndex){var withLeafBins=refIndex.binseq.filter(function(o){return o.bin>=start16kbBinid&&o.bin<=end16kbBinid}),refsegs=withLeafBins.reduce(function(segs,o){var b=o.bin,relBinNum=b-start16kbBinid,position=relBinNum*_16KB,readDepth=o.chunkseq.reduce(function(bc,chunk){var b=chunk.cnk_beg.valueOf(),e=chunk.cnk_end.valueOf();return bc+(rshift16(e)-rshift16(b))},0);return segs.push({relBinNum:relBinNum,pos:position,depth:readDepth}),segs},[]);return refsegs}function estimateCoverageDepth(indexReader,cb){var rdrThis=indexReader;if(rdrThis.estimates)return cb&&cb.call(rdrThis,rdrThis.estimates),rdrThis.estimates;var indexWreads=rdrThis.idxContent.indexseq.reduce(function(V,x,i,_){return 0==x.n_bin&&0==x.n_intv||V.push([x,i]),V},[]);return rdrThis.estimates=indexWreads.reduce(function(RD,I){var ref=I[1];return RD[ref]=estimateRefCoverageDepth(I[0]),RD},{}),estimateCoverageDepth(indexReader,cb)}function mapSegCoverage(indexReader,refid,fn,keepNils){indexReader.estimates||estimateCoverageDepth(indexReader);for(var info=function(i){var e=indexReader.estimates[refid][i];return e?e:{relBinNum:i,pos:16384*i,depth:0}},res=[],i=0;end16kbBinid-start16kbBinid>i;i++){var user_res=fn.call(indexReader,info(i));keepNils?res.push(user_res):user_res&&res.push(user_res)}return res}function samplingRegions(refs,options){console.log("samplingRegions, refs & options: ",refs,options);var options=options?options:{},bsize=options.binSize||4e4,bcnt=options.binNumber||20,start=options.start||1,refs=refs[0].end?old2newRefs(refs):refs,regions=refs.reduce(function(regs,ref){var len=ref.l_ref-start;if(len>0&&bcnt*bsize>len)regs.push({name:ref.name,start:start,end:ref.l_ref});else if(len>0)for(var i=0;bcnt>i;i++){var nstart=start+Math.floor(Math.random()*len);regs.push({name:ref.name,start:nstart,end:nstart+bsize})}return regs},[]);return regions=regions.sort(function(l,r){return l.name==r.name?parseInt(l.start)-parseInt(r.start):_spred(l.name,r.name)})}function new2oldRefs(refs){return refs.map(function(ref){return{name:ref.name,end:ref.l_ref}})}function old2newRefs(refs){return refs.map(function(ref){return{name:ref.name,l_ref:ref.end}})}function getBamRegionsUrl(regions){if("url"==this.sourceType){var regionStr="";regions.forEach(function(region){region.start?regionStr+=" "+region.name+":"+region.start+"-"+region.end:console.log("ERROR, undefined region start",region)});var url=this.iobio.samtools+"?cmd= view -b "+this.bamUri+regionStr+"&encoding=binary"}return encodeURI(url)}function bamStatsAliveSamplingURL(refs,options,bsaliveURL){var regionInfo=samplingRegions(refs,options),regions=regionInfo.regions,regstr=regionInfo.regstr;return encodeURI(bsaliveURL+"?cmd=-u 3000 -r '"+regstr+"' "+encodeURIComponent(getBamRegionsUrl(regions)))}function appendBuffer(buff1,buff2,asUint8){var tmp=new Uint8Array(buff1.byteLength+buff2.byteLength),b1=buff1 instanceof Uint8Array?buff1:new Uint8Array(buff1),b2=buff2 instanceof Uint8Array?buff2:new Uint8Array(buff2);return tmp.set(b1,0),tmp.set(b2,b1.byteLength),asUint8?tmp:tmp.buffer}function appendBuffers(bufferVec,asUint8){for(var totalSize=0,i=0;i<bufferVec.length;i++)totalSize+=bufferVec[i].byteLength;var tmp;if(1==bufferVec.length){var b=bufferVec[0];tmp=b instanceof Uint8Array?b:new Uint8Array(b)}else{tmp=new Uint8Array(totalSize);for(var offset=0,i=0;i<bufferVec.length;i++){var b=bufferVec[i],buff=b instanceof Uint8Array?b:new Uint8Array(b);tmp.set(buff,offset),offset+=b.byteLength}}return asUint8?tmp:tmp.buffer}function buffer2String(resultBuffer){for(var s="",resultBB=new Uint8Array(resultBuffer),i=0;i<resultBB.length;++i)s+=String.fromCharCode(resultBB[i]);return s}function getChunk(f,beg,end,cbfn){var reader=new FileReader;reader.onloadend=function(evt){return evt.target.readyState==FileReader.DONE?cbfn.call(this,reader):alert("Bad read for "+f+" at "+beg+", "+end+"status: "+evt.target.readyState)},reader.readAsArrayBuffer(f.slice(beg,end))}function getBGZFHD(f,offset,cbfn){var cb=function(r){var a=new Uint8Array(r.result),hdbuf=a.buffer,parser=new jParser(hdbuf,bgzf_hd_fmt),hdobj=parser.parse("bgzfHd");return cbfn.call(this,hdobj)};getChunk(f,offset,offset+hdSize,cb)}function nextBlockOffset(f,offset,cbfn){var cb=function(hdobj){var bsize=hdobj.subhead.bsize;return cbfn.call(this,offset+bsize+1)};getBGZFHD(f,offset,cb)}function blockSize(f,offset,cbfn){var cb=function(hdobj){var blksize=hdobj.subhead.bsize+1;return cbfn.call(this,blksize)};getBGZFHD(f,offset,cb)}function countBlocks(f,cbfn){var blkCnt=1,cb=function(x){x<files[0].size?(blkCnt+=1,nextBlockOffset(f,x,cb)):cbfn.call(this,blkCnt)};nextBlockOffset(f,0,cb)}function inflateBlock(f,blockOffset,cbfn){var cb2=function(r){var a=new Uint8Array(r.result),inBuffer=a.buffer,resBuf=jszlib_inflate_buffer(inBuffer,hdSize,a.length-hdSize);return cbfn.call(this,resBuf)},cb=function(blksize){getChunk(f,blockOffset,blockOffset+blksize,cb2)};blockSize(f,blockOffset,cb)}function inflateBlock2stg(f,blockOffset,cbfn){var cb=function(resBuf){var res=buffer2String(resBuf);return cbfn.call(this,res)};inflateBlock(f,blockOffset,cb)}function inflateRegion(f,begOffset,endOffset,cbfn){var blockOffset=begOffset,res=[],cb=function(x){res.push(x),nextBlockOffset(f,blockOffset,function(x){if(blockOffset=x,endOffset>=blockOffset)return inflateBlock(f,blockOffset,cb);var resBuf=appendBuffers(res);return cbfn.call(this,resBuf,res.slice(-1)[0].byteLength)})};inflateBlock(f,blockOffset,cb)}function inflateAllBlocks(f,cbfn){return inflateRegion(f,0,f.size-1,cbfn)}function inflateRegion2Stg(f,begOffset,endOffset,cbfn){var cb=function(resBuf,ebsz){var res=buffer2String(resBuf);return cbfn.call(this,res,ebsz)};inflateRegion(f,begOffset,endOffset,cb)}function inflateAll2Stg(f,cbfn){var cb=function(resBuf){var res=buffer2String(resBuf);return cbfn.call(this,res)};inflateAllBlocks(f,cb)}function bgzf(uba){var bgzfUba=new pako.gzip(uba,{header:{os:255,time:0,extra:new Uint8Array([66,67,2,0,255,255])}}),bsize=bgzfUba.length-1,b0=255&bsize,b1=bsize>>8;return bgzfUba[16]=b0,bgzfUba[17]=b1,bgzfUba}function addEOFblk(bgzfUba){return appendBuffer(bgzfUba,EOFblk)}function readBinaryFile(evt){files=evt.target.files;var f=files[0],cb=function(x){console.log(x)};this.theFile=f,console.log(f.name);var isBai="bai"==f.name.split(".").slice(-1)[0];if(f)if(isBai){var r=new readBaiFile(f);r.getIndex(function(bai){console.log(r.idxContent),console.log(r.bhash)})}else getBGZFHD(f,0,cb),blockSize(f,0,cb),nextBlockOffset(f,0,cb);else alert("Failed to load file")}function readBaiFile(baiFile){if(!(this instanceof arguments.callee))throw new Error("Constructor may not be called as a function");this.theFile=baiFile,this.baiThis=this}function readBinaryBAM(baiFile,bamFile,cb){if(!(this instanceof arguments.callee))throw new Error("Constructor may not be called as a function");var r=new readBaiFile(baiFile);this.theFile=bamFile,this.baiR=r,this.bamThis=this,r.getIndex(cb)}function getBamRefs(p,cb){var rcnt=0,refs=[],getRef=function(x){rcnt++,refs.push(x),rcnt<p.head.n_ref?nextParseRes(p,"reference",getRef):cb.call(this,refs)};nextParseRes(p,"reference",getRef)}function _getAlnUbas(p,cb){var aln_ubas=[],getAlnUba=function(x){aln_ubas.push(x),p.tell()<p.len?nextParseRes(p,"uba_aln",getAlnUba):cb.call(this,aln_ubas)};nextParseRes(p,"uba_aln",getAlnUba)}function _getRegAlnUba(p){for(var beg=p.tell(),bsize=p.parse("int32"),end=beg+bsize+4,aln_blksizes=[bsize];end<p.len;)p.seek(p.tell()+bsize),bsize=p.parse("int32"),aln_blksizes.push(bsize),end=end+bsize+4;return{beg:beg,aln_blksizes:aln_blksizes,end:end}}function alnInfo2BgzfBlks(alninfos){var alninfos=alninfos instanceof Array?alninfos:[alninfos],bgzf_blks=alninfos.reduce(function(Bs,alninfo){return Bs.concat(getBgzfBlocks(get65KBCnkUbas(get65KBCnkBlkSizes(alninfo.aln_blksizes),alninfo.beg,alninfo.uba)[0]))},[]);return bgzf_blks}function alnCnkUbas(alninfos){var alninfos=alninfos instanceof Array?alninfos:[alninfos],alnubas=alninfos.reduce(function(Bs,alninfo){return Bs.concat(get65KBCnkUbas(get65KBCnkBlkSizes(alninfo.aln_blksizes),alninfo.beg,alninfo.uba)[0])},[]);return alnubas}function coalesce65KBCnks(alnubas){var grp65kbUbas=alnubas.reduce(function(Cnks,uba){var cur=Cnks.pop();cur=cur?cur:[];var tsm=cur.reduce(function(S,x){return S+x.length},0);return tsm+uba.length<_65kb?(cur.push(uba),Cnks.push(cur)):(Cnks.push(cur),Cnks.push([uba])),Cnks},[]);tmpubas=grp65kbUbas;var coalescedUbas=grp65kbUbas.reduce(function(Ubas,grp){return Ubas.push(appendBuffers(grp,!0)),Ubas},[]);return coalescedUbas}function get65KBCnkBlkSizes(blksizes){return blksizes.reduce(function(Cnks,bsz){var cur=Cnks.pop();cur=cur?cur:[];var tsm=cur.reduce(function(S,x){return S+x+4},0);return _65kb>tsm+bsz+4?(cur.push(bsz),Cnks.push(cur)):(Cnks.push(cur),Cnks.push([bsz])),Cnks},[])}function get65KBCnkUbas(sets65KBblksizes,beg,uba){return sets65KBblksizes.reduce(function(Bs,szs){var bufs=Bs[0],offset=Bs[1],sz=szs.reduce(function(S,x){return S+x+4},0),end=offset+sz,nbuf=uba.subarray(offset,end);return bufs.push(nbuf),Bs[0]=bufs,Bs[1]=end,Bs},[[],beg])}function getBgzfBlocks(cnkubas){return cnkubas.reduce(function(bgzfUbas,cnkuba){return bgzfUbas.push(bgzf(cnkuba)),bgzfUbas},[])}function cigarOp(n){return"MIDNSHP=X"[n]}function cigarInfo(cigar){return{op:cigarOp(15&cigar),op_len:cigar>>>4}}function nyble2aa(n){return"=ACMGRSVTWYHKDBN"[n]}function byte2aas(b){var x=[nyble2aa(b>>>4),nyble2aa(15&b)];return x.join("")}function seq2aas(seq){var aapairs=_.map(seq,byte2aas);return aapairs.join("")}!function(exports){function BufferBuilder(){this._pieces=[],this._parts=[]}function Unpacker(data){this.index=0,this.dataBuffer=data,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function Packer(){this.bufferBuilder=new BufferBuilder}function EventEmitter(){this._events={}}function Stream(){EventEmitter.call(this)}function BlobReadStream(source,options){Stream.call(this),options=util.extend({readDelay:0,paused:!1},options),this._source=source,this._start=0,this._readChunkSize=options.chunkSize||source.size,this._readDelay=options.readDelay,this.readable=!0,this.paused=options.paused,this._read()}function BinaryStream(socket,id,create,meta){if(!(this instanceof BinaryStream))return new BinaryStream(options);Stream.call(this),this.id=id,this._socket=socket,this.writable=!0,this.readable=!0,this.paused=!1,this._closed=!1,this._ended=!1,create&&this._write(1,meta,this.id)}function BinaryClient(socket,options){if(!(this instanceof BinaryClient))return new BinaryClient(socket,options);EventEmitter.call(this);var self=this;this._options=util.extend({chunkSize:40960},options),this.streams={},"string"==typeof socket?(this._nextId=0,this._socket=new WebSocket(socket)):(this._nextId=1,this._socket=socket),this._socket.binaryType="arraybuffer",this._socket.addEventListener("open",function(){self.emit("open")}),this._socket.addEventListener("error",function(error){for(var ids=Object.keys(self.streams),i=0,ii=ids.length;ii>i;i++)self.streams[ids[i]]._onError(error);self.emit("error",error)}),this._socket.addEventListener("close",function(code,message){for(var ids=Object.keys(self.streams),i=0,ii=ids.length;ii>i;i++)self.streams[ids[i]]._onClose();self.emit("close",code,message)}),this._socket.addEventListener("message",function(data,flags){util.setZeroTimeout(function(){data=data.data;try{data=util.unpack(data)}catch(ex){return self.emit("error",new Error("Received unparsable message: "+ex))}if(!(data instanceof Array))return self.emit("error",new Error("Received non-array message"));if(3!=data.length)return self.emit("error",new Error("Received message with wrong part count: "+data.length));if("number"!=typeof data[0])return self.emit("error",new Error("Received message with non-number type: "+data[0]));switch(data[0]){case 0:break;case 1:var meta=data[1],streamId=data[2],binaryStream=self._receiveStream(streamId);self.emit("stream",binaryStream,meta);break;case 2:var payload=data[1],streamId=data[2],binaryStream=self.streams[streamId];binaryStream?binaryStream._onData(payload):self.emit("error",new Error("Received `data` message for unknown stream: "+streamId));break;case 3:var streamId=data[2],binaryStream=self.streams[streamId];binaryStream?binaryStream._onPause():self.emit("error",new Error("Received `pause` message for unknown stream: "+streamId));break;case 4:var streamId=data[2],binaryStream=self.streams[streamId];binaryStream?binaryStream._onResume():self.emit("error",new Error("Received `resume` message for unknown stream: "+streamId));break;case 5:var streamId=data[2],binaryStream=self.streams[streamId];binaryStream?binaryStream._onEnd():self.emit("error",new Error("Received `end` message for unknown stream: "+streamId));break;case 6:var streamId=data[2],binaryStream=self.streams[streamId];binaryStream?binaryStream._onClose():self.emit("error",new Error("Received `close` message for unknown stream: "+streamId));break;case 7:var errorInfo=data[1],streamId=data[2],binaryStream=self.streams[streamId];binaryStream?binaryStream._onUError(errorInfo):self.emit("error",new Error("Received `error` message for unknown stream: "+streamId));break;default:self.emit("error",new Error("Unrecognized message type received: "+data[0]))}})})}var binaryFeatures={};binaryFeatures.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),binaryFeatures.useArrayBufferView=!binaryFeatures.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),binaryFeatures.supportsBinaryWebsockets=function(){try{var wstest=new WebSocket("ws://null");return wstest.onerror=function(){},"undefined"!=typeof wstest.binaryType}catch(e){return!1}}(),exports.binaryFeatures=binaryFeatures,exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder,BufferBuilder.prototype.append=function(data){"number"==typeof data?this._pieces.push(data):(this.flush(),this._parts.push(data))},BufferBuilder.prototype.flush=function(){if(this._pieces.length>0){var buf=new Uint8Array(this._pieces);binaryFeatures.useArrayBufferView||(buf=buf.buffer),this._parts.push(buf),this._pieces=[]}},BufferBuilder.prototype.getBuffer=function(){if(this.flush(),binaryFeatures.useBlobBuilder){for(var builder=new BlobBuilder,i=0,ii=this._parts.length;ii>i;i++)builder.append(this._parts[i]);return builder.getBlob()}return new Blob(this._parts)},exports.BinaryPack={unpack:function(data){var unpacker=new Unpacker(data);return unpacker.unpack()},pack:function(data){var packer=new Packer;packer.pack(data);var buffer=packer.getBuffer();return buffer}},Unpacker.prototype.unpack=function(){var type=this.unpack_uint8();if(128>type){var positive_fixnum=type;return positive_fixnum}if(32>(224^type)){var negative_fixnum=(224^type)-32;return negative_fixnum}var size;if((size=160^type)<=15)return this.unpack_raw(size);if((size=176^type)<=15)return this.unpack_string(size);if((size=144^type)<=15)return this.unpack_array(size);if((size=128^type)<=15)return this.unpack_map(size);switch(type){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return size=this.unpack_uint16(),this.unpack_string(size);case 217:return size=this.unpack_uint32(),this.unpack_string(size);case 218:return size=this.unpack_uint16(),this.unpack_raw(size);case 219:return size=this.unpack_uint32(),this.unpack_raw(size);case 220:return size=this.unpack_uint16(),this.unpack_array(size);case 221:return size=this.unpack_uint32(),this.unpack_array(size);case 222:return size=this.unpack_uint16(),this.unpack_map(size);case 223:return size=this.unpack_uint32(),this.unpack_map(size)}},Unpacker.prototype.unpack_uint8=function(){var byte=255&this.dataView[this.index];return this.index++,byte},Unpacker.prototype.unpack_uint16=function(){var bytes=this.read(2),uint16=256*(255&bytes[0])+(255&bytes[1]);return this.index+=2,uint16},Unpacker.prototype.unpack_uint32=function(){var bytes=this.read(4),uint32=256*(256*(256*bytes[0]+bytes[1])+bytes[2])+bytes[3];return this.index+=4,uint32},Unpacker.prototype.unpack_uint64=function(){var bytes=this.read(8),uint64=256*(256*(256*(256*(256*(256*(256*bytes[0]+bytes[1])+bytes[2])+bytes[3])+bytes[4])+bytes[5])+bytes[6])+bytes[7];return this.index+=8,uint64},Unpacker.prototype.unpack_int8=function(){var uint8=this.unpack_uint8();return 128>uint8?uint8:uint8-256},Unpacker.prototype.unpack_int16=function(){var uint16=this.unpack_uint16();return 32768>uint16?uint16:uint16-65536},Unpacker.prototype.unpack_int32=function(){var uint32=this.unpack_uint32();return uint32<Math.pow(2,31)?uint32:uint32-Math.pow(2,32)},Unpacker.prototype.unpack_int64=function(){var uint64=this.unpack_uint64();return uint64<Math.pow(2,63)?uint64:uint64-Math.pow(2,64)},Unpacker.prototype.unpack_raw=function(size){if(this.length<this.index+size)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+size+" "+this.length);var buf=this.dataBuffer.slice(this.index,this.index+size);return this.index+=size,buf},Unpacker.prototype.unpack_string=function(size){for(var c,code,bytes=this.read(size),i=0,str="";size>i;)c=bytes[i],128>c?(str+=String.fromCharCode(c),i++):32>(192^c)?(code=(192^c)<<6|63&bytes[i+1],str+=String.fromCharCode(code),i+=2):(code=(15&c)<<12|(63&bytes[i+1])<<6|63&bytes[i+2],str+=String.fromCharCode(code),i+=3);return this.index+=size,str},Unpacker.prototype.unpack_array=function(size){for(var objects=new Array(size),i=0;size>i;i++)objects[i]=this.unpack();return objects},Unpacker.prototype.unpack_map=function(size){for(var map={},i=0;size>i;i++){var key=this.unpack(),value=this.unpack();map[key]=value}return map},Unpacker.prototype.unpack_float=function(){var uint32=this.unpack_uint32(),sign=uint32>>31,exp=(uint32>>23&255)-127,fraction=8388607&uint32|8388608;return(0==sign?1:-1)*fraction*Math.pow(2,exp-23)},Unpacker.prototype.unpack_double=function(){var h32=this.unpack_uint32(),l32=this.unpack_uint32(),sign=h32>>31,exp=(h32>>20&2047)-1023,hfrac=1048575&h32|1048576,frac=hfrac*Math.pow(2,exp-20)+l32*Math.pow(2,exp-52);return(0==sign?1:-1)*frac},Unpacker.prototype.read=function(length){var j=this.index;if(j+length<=this.length)return this.dataView.subarray(j,j+length);throw new Error("BinaryPackFailure: read index out of range")},Packer.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},Packer.prototype.pack=function(value){var type=typeof value;if("string"==type)this.pack_string(value);else if("number"==type)Math.floor(value)===value?this.pack_integer(value):this.pack_double(value);else if("boolean"==type)value===!0?this.bufferBuilder.append(195):value===!1&&this.bufferBuilder.append(194);else if("undefined"==type)this.bufferBuilder.append(192);else{if("object"!=type)throw new Error('Type "'+type+'" not yet supported');if(null===value)this.bufferBuilder.append(192);else{var constructor=value.constructor;if(constructor==Array)this.pack_array(value);else if(constructor==Blob||constructor==File)this.pack_bin(value);else if(constructor==ArrayBuffer)binaryFeatures.useArrayBufferView?this.pack_bin(new Uint8Array(value)):this.pack_bin(value);else if("BYTES_PER_ELEMENT"in value)binaryFeatures.useArrayBufferView?this.pack_bin(new Uint8Array(value.buffer)):this.pack_bin(value.buffer);else if(constructor==Object)this.pack_object(value);else if(constructor==Date)this.pack_string(value.toString());else{if("function"!=typeof value.toBinaryPack)throw new Error('Type "'+constructor.toString()+'" not yet supported');this.bufferBuilder.append(value.toBinaryPack())}}}this.bufferBuilder.flush()},Packer.prototype.pack_bin=function(blob){var length=blob.length||blob.byteLength||blob.size;if(15>=length)this.pack_uint8(160+length);else if(65535>=length)this.bufferBuilder.append(218),this.pack_uint16(length);else{if(!(4294967295>=length))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(length)}this.bufferBuilder.append(blob)},Packer.prototype.pack_string=function(str){var length=str.length;if(15>=length)this.pack_uint8(176+length);else if(65535>=length)this.bufferBuilder.append(216),this.pack_uint16(length);else{if(!(4294967295>=length))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(length)}this.bufferBuilder.append(str)},Packer.prototype.pack_array=function(ary){var length=ary.length;if(15>=length)this.pack_uint8(144+length);else if(65535>=length)this.bufferBuilder.append(220),this.pack_uint16(length);else{if(!(4294967295>=length))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(length)}for(var i=0;length>i;i++)this.pack(ary[i])},Packer.prototype.pack_integer=function(num){if(num>=-32&&127>=num)this.bufferBuilder.append(255&num);else if(num>=0&&255>=num)this.bufferBuilder.append(204),this.pack_uint8(num);else if(num>=-128&&127>=num)this.bufferBuilder.append(208),this.pack_int8(num);else if(num>=0&&65535>=num)this.bufferBuilder.append(205),this.pack_uint16(num);else if(num>=-32768&&32767>=num)this.bufferBuilder.append(209),this.pack_int16(num);else if(num>=0&&4294967295>=num)this.bufferBuilder.append(206),this.pack_uint32(num);else if(num>=-2147483648&&2147483647>=num)this.bufferBuilder.append(210),this.pack_int32(num);else if(num>=-0x8000000000000000&&0x8000000000000000>=num)this.bufferBuilder.append(211),this.pack_int64(num);else{if(!(num>=0&&0x10000000000000000>=num))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(num)}},Packer.prototype.pack_double=function(num){var sign=0;0>num&&(sign=1,num=-num);var exp=Math.floor(Math.log(num)/Math.LN2),frac0=num/Math.pow(2,exp)-1,frac1=Math.floor(frac0*Math.pow(2,52)),b32=Math.pow(2,32),h32=sign<<31|exp+1023<<20|frac1/b32&1048575,l32=frac1%b32;this.bufferBuilder.append(203),this.pack_int32(h32),this.pack_int32(l32)},Packer.prototype.pack_object=function(obj){var keys=Object.keys(obj),length=keys.length;if(15>=length)this.pack_uint8(128+length);else if(65535>=length)this.bufferBuilder.append(222),this.pack_uint16(length);else{if(!(4294967295>=length))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(length)}for(var prop in obj)obj.hasOwnProperty(prop)&&(this.pack(prop),this.pack(obj[prop]))},Packer.prototype.pack_uint8=function(num){this.bufferBuilder.append(num)},Packer.prototype.pack_uint16=function(num){this.bufferBuilder.append(num>>8),this.bufferBuilder.append(255&num)},Packer.prototype.pack_uint32=function(num){var n=4294967295&num;this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},Packer.prototype.pack_uint64=function(num){var high=num/Math.pow(2,32),low=num%Math.pow(2,32);this.bufferBuilder.append((4278190080&high)>>>24),this.bufferBuilder.append((16711680&high)>>>16),this.bufferBuilder.append((65280&high)>>>8),this.bufferBuilder.append(255&high),this.bufferBuilder.append((4278190080&low)>>>24),this.bufferBuilder.append((16711680&low)>>>16),this.bufferBuilder.append((65280&low)>>>8),this.bufferBuilder.append(255&low)},Packer.prototype.pack_int8=function(num){this.bufferBuilder.append(255&num)},Packer.prototype.pack_int16=function(num){this.bufferBuilder.append((65280&num)>>8),this.bufferBuilder.append(255&num)},Packer.prototype.pack_int32=function(num){this.bufferBuilder.append(num>>>24&255),this.bufferBuilder.append((16711680&num)>>>16),this.bufferBuilder.append((65280&num)>>>8),this.bufferBuilder.append(255&num)},Packer.prototype.pack_int64=function(num){var high=Math.floor(num/Math.pow(2,32)),low=num%Math.pow(2,32);this.bufferBuilder.append((4278190080&high)>>>24),this.bufferBuilder.append((16711680&high)>>>16),this.bufferBuilder.append((65280&high)>>>8),this.bufferBuilder.append(255&high),this.bufferBuilder.append((4278190080&low)>>>24),this.bufferBuilder.append((16711680&low)>>>16),this.bufferBuilder.append((65280&low)>>>8),this.bufferBuilder.append(255&low)};var isArray=Array.isArray;EventEmitter.prototype.addListener=function(type,listener,scope,once){if("function"!=typeof listener)throw new Error("addListener only takes instances of Function");return this.emit("newListener",type,"function"==typeof listener.listener?listener.listener:listener),this._events[type]?isArray(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,
this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener,scope){function g(){self.removeListener(type,g),listener.apply(this,arguments)}if("function"!=typeof listener)throw new Error(".once only takes instances of Function");var self=this;return g.listener=listener,self.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener,scope){if("function"!=typeof listener)throw new Error("removeListener only takes instances of Function");if(!this._events[type])return this;var list=this._events[type];if(isArray(list)){for(var position=-1,i=0,length=list.length;length>i;i++)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(0>position)return this;list.splice(position,1),0==list.length&&delete this._events[type]}else(list===listener||list.listener&&list.listener===listener)&&delete this._events[type];return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(type){return 0===arguments.length?(this._events={},this):(type&&this._events&&this._events[type]&&(this._events[type]=null),this)},EventEmitter.prototype.listeners=function(type){return this._events[type]||(this._events[type]=[]),isArray(this._events[type])||(this._events[type]=[this._events[type]]),this._events[type]},EventEmitter.prototype.emit=function(type){var type=arguments[0],handler=this._events[type];if(!handler)return!1;if("function"==typeof handler){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(var l=arguments.length,args=new Array(l-1),i=1;l>i;i++)args[i-1]=arguments[i];handler.apply(this,args)}return!0}if(isArray(handler)){for(var l=arguments.length,args=new Array(l-1),i=1;l>i;i++)args[i-1]=arguments[i];for(var listeners=handler.slice(),i=0,l=listeners.length;l>i;i++)listeners[i].apply(this,args);return!0}return!1};var util={inherits:function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},extend:function(dest,source){for(var key in source)source.hasOwnProperty(key)&&(dest[key]=source[key]);return dest},pack:BinaryPack.pack,unpack:BinaryPack.unpack,setZeroTimeout:function(global){function setZeroTimeoutPostMessage(fn){timeouts.push(fn),global.postMessage(messageName,"*")}function handleMessage(event){event.source==global&&event.data==messageName&&(event.stopPropagation&&event.stopPropagation(),timeouts.length&&timeouts.shift()())}var timeouts=[],messageName="zero-timeout-message";return global.addEventListener?global.addEventListener("message",handleMessage,!0):global.attachEvent&&global.attachEvent("onmessage",handleMessage),setZeroTimeoutPostMessage}(this)};exports.util=util,util.inherits(Stream,EventEmitter),Stream.prototype.pipe=function(dest,options){function ondata(chunk){dest.writable&&!1===dest.write(chunk)&&source.pause&&source.pause()}function ondrain(){source.readable&&source.resume&&source.resume()}function onend(){didOnEnd||(didOnEnd=!0,dest.end())}function onclose(){didOnEnd||(didOnEnd=!0,dest.destroy())}function onerror(er){if(cleanup(),0===this.listeners("error").length)throw er}function cleanup(){source.removeListener("data",ondata),dest.removeListener("drain",ondrain),source.removeListener("end",onend),source.removeListener("close",onclose),source.removeListener("error",onerror),dest.removeListener("error",onerror),source.removeListener("end",cleanup),source.removeListener("close",cleanup),dest.removeListener("end",cleanup),dest.removeListener("close",cleanup)}var source=this;source.on("data",ondata),dest.on("drain",ondrain),dest._isStdio||options&&options.end===!1||(source.on("end",onend),source.on("close",onclose));var didOnEnd=!1;return source.on("error",onerror),dest.on("error",onerror),source.on("end",cleanup),source.on("close",cleanup),dest.on("end",cleanup),dest.on("close",cleanup),dest.emit("pipe",source),dest},exports.Stream=Stream,util.inherits(BlobReadStream,Stream),BlobReadStream.prototype.pause=function(){this.paused=!0},BlobReadStream.prototype.resume=function(){this.paused=!1,this._read()},BlobReadStream.prototype.destroy=function(){this.readable=!1,clearTimeout(this._timeoutId)},BlobReadStream.prototype._read=function(){function emitReadChunk(){self._emitReadChunk()}var self=this,readDelay=this._readDelay;0!==readDelay?this._timeoutId=setTimeout(emitReadChunk,readDelay):util.setZeroTimeout(emitReadChunk)},BlobReadStream.prototype._emitReadChunk=function(){if(!this.paused&&this.readable){var chunkSize=Math.min(this._source.size-this._start,this._readChunkSize);if(0===chunkSize)return this.readable=!1,void this.emit("end");var sourceEnd=this._start+chunkSize,chunk=(this._source.slice||this._source.webkitSlice||this._source.mozSlice).call(this._source,this._start,sourceEnd);this._start=sourceEnd,this._read(),this.emit("data",chunk)}},exports.BlobReadStream=BlobReadStream,util.inherits(BinaryStream,Stream),BinaryStream.prototype._onDrain=function(){this.paused||this.emit("drain")},BinaryStream.prototype._onClose=function(){this._closed||(this.readable=!1,this.writable=!1,this._closed=!0,this.emit("close"))},BinaryStream.prototype._onError=function(error){this.readable=!1,this.writable=!1,this.emit("error",error)},BinaryStream.prototype._onPause=function(){this.paused=!0,this.emit("pause")},BinaryStream.prototype._onResume=function(){this.paused=!1,this.emit("resume"),this.emit("drain")},BinaryStream.prototype._write=function(code,data,bonus){if(this._socket.readyState!==this._socket.constructor.OPEN)return!1;var message=util.pack([code,data,bonus]);return this._socket.send(message)!==!1},BinaryStream.prototype.write=function(data){if(this.writable){var out=this._write(2,data,this.id);return!this.paused&&out}return this.emit("error",new Error("Stream is not writable")),!1},BinaryStream.prototype.end=function(){this._ended=!0,this.readable=!1,this._write(5,null,this.id)},BinaryStream.prototype.destroy=BinaryStream.prototype.destroySoon=function(){this._onClose(),this._write(6,null,this.id)},BinaryStream.prototype._onEnd=function(){this._ended||(this._ended=!0,this.readable=!1,this.emit("end"))},BinaryStream.prototype._onData=function(data){this.emit("data",data)},BinaryStream.prototype._onUError=function(errorInfo){this.emit("uerror",errorInfo)},BinaryStream.prototype.pause=function(){this._onPause(),this._write(3,null,this.id)},BinaryStream.prototype.resume=function(){this._onResume(),this._write(4,null,this.id)},util.inherits(BinaryClient,EventEmitter),BinaryClient.prototype.send=function(data,meta){var stream=this.createStream(meta);if(data instanceof Stream)data.pipe(stream);else if(util.isNode===!0)Buffer.isBuffer(data)?new BufferReadStream(data,{chunkSize:this._options.chunkSize}).pipe(stream):stream.write(data);else if(util.isNode!==!0)if(data.constructor==Blob||data.constructor==File)new BlobReadStream(data,{chunkSize:this._options.chunkSize}).pipe(stream);else if(data.constructor==ArrayBuffer){var blob;if(binaryFeatures.useArrayBufferView&&(data=new Uint8Array(data)),binaryFeatures.useBlobBuilder){var builder=new BlobBuilder;builder.append(data),blob=builder.getBlob()}else blob=new Blob([data]);new BlobReadStream(blob,{chunkSize:this._options.chunkSize}).pipe(stream)}else if("object"==typeof data&&"BYTES_PER_ELEMENT"in data){var blob;if(binaryFeatures.useArrayBufferView||(data=data.buffer),binaryFeatures.useBlobBuilder){var builder=new BlobBuilder;builder.append(data),blob=builder.getBlob()}else blob=new Blob([data]);new BlobReadStream(blob,{chunkSize:this._options.chunkSize}).pipe(stream)}else stream.write(data);return stream},BinaryClient.prototype._receiveStream=function(streamId){var self=this,binaryStream=new BinaryStream(this._socket,streamId,!1);return binaryStream.on("close",function(){delete self.streams[streamId]}),this.streams[streamId]=binaryStream,binaryStream},BinaryClient.prototype.createStream=function(meta){if(this._socket.readyState!==WebSocket.OPEN)throw new Error("Client is not yet connected or has closed");var self=this,streamId=this._nextId;this._nextId+=2;var binaryStream=new BinaryStream(this._socket,streamId,!0,meta);return binaryStream.on("close",function(){delete self.streams[streamId]}),this.streams[streamId]=binaryStream,binaryStream},BinaryClient.prototype.close=BinaryClient.prototype.destroy=function(){this._socket.close()},exports.BinaryClient=BinaryClient}(this);var MAX_WBITS=15,DEF_WBITS=MAX_WBITS,MAX_MEM_LEVEL=9,MANY=1440,BMAX=15,PRESET_DICT=32,Z_NO_FLUSH=0,Z_PARTIAL_FLUSH=1,Z_SYNC_FLUSH=2,Z_FULL_FLUSH=3,Z_FINISH=4,Z_DEFLATED=8,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_ERRNO=-1,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_VERSION_ERROR=-6,METHOD=0,FLAG=1,DICT4=2,DICT3=3,DICT2=4,DICT1=5,DICT0=6,BLOCKS=7,CHECK4=8,CHECK3=9,CHECK2=10,CHECK1=11,DONE=12,BAD=13,inflate_mask=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],IB_TYPE=0,IB_LENS=1,IB_STORED=2,IB_TABLE=3,IB_BTREE=4,IB_DTREE=5,IB_CODES=6,IB_DRY=7,IB_DONE=8,IB_BAD=9,fixed_bl=9,fixed_bd=5,fixed_tl=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],fixed_td=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];ZStream.prototype.inflateInit=function(w,nowrap){return w||(w=DEF_WBITS),nowrap&&(nowrap=!1),this.istate=new Inflate,this.istate.inflateInit(this,nowrap?-w:w)},ZStream.prototype.inflate=function(f){return null==this.istate?Z_STREAM_ERROR:this.istate.inflate(this,f)},ZStream.prototype.inflateEnd=function(){if(null==this.istate)return Z_STREAM_ERROR;var ret=istate.inflateEnd(this);return this.istate=null,ret},ZStream.prototype.inflateSync=function(){return istate.inflateSync(this)},ZStream.prototype.inflateSetDictionary=function(dictionary,dictLength){return istate.inflateSetDictionary(this,dictionary,dictLength)},Inflate.prototype.inflateReset=function(z){return null==z||null==z.istate?Z_STREAM_ERROR:(z.total_in=z.total_out=0,z.msg=null,z.istate.mode=0!=z.istate.nowrap?BLOCKS:METHOD,z.istate.blocks.reset(z,null),Z_OK)},Inflate.prototype.inflateEnd=function(z){return null!=this.blocks&&this.blocks.free(z),this.blocks=null,Z_OK},Inflate.prototype.inflateInit=function(z,w){return z.msg=null,this.blocks=null,nowrap=0,0>w&&(w=-w,nowrap=1),8>w||w>15?(this.inflateEnd(z),Z_STREAM_ERROR):(this.wbits=w,z.istate.blocks=new InfBlocks(z,0!=z.istate.nowrap?null:this,1<<w),this.inflateReset(z),Z_OK)},Inflate.prototype.inflate=function(z,f){var r,b;if(null==z||null==z.istate||null==z.next_in)return Z_STREAM_ERROR;for(f=f==Z_FINISH?Z_BUF_ERROR:Z_OK,r=Z_BUF_ERROR;;)switch(z.istate.mode){case METHOD:if(0==z.avail_in)return r;if(r=f,z.avail_in--,z.total_in++,(15&(z.istate.method=z.next_in[z.next_in_index++]))!=Z_DEFLATED){z.istate.mode=BAD,z.msg="unknown compression method",z.istate.marker=5;break}if((z.istate.method>>4)+8>z.istate.wbits){z.istate.mode=BAD,z.msg="invalid window size",z.istate.marker=5;break}z.istate.mode=FLAG;case FLAG:if(0==z.avail_in)return r;if(r=f,z.avail_in--,z.total_in++,b=255&z.next_in[z.next_in_index++],((z.istate.method<<8)+b)%31!=0){z.istate.mode=BAD,z.msg="incorrect header check",z.istate.marker=5;break}if(0==(b&PRESET_DICT)){z.istate.mode=BLOCKS;break}z.istate.mode=DICT4;case DICT4:if(0==z.avail_in)return r;r=f,z.avail_in--,z.total_in++,z.istate.need=(255&z.next_in[z.next_in_index++])<<24&4278190080,z.istate.mode=DICT3;case DICT3:if(0==z.avail_in)return r;r=f,z.avail_in--,z.total_in++,z.istate.need+=(255&z.next_in[z.next_in_index++])<<16&16711680,z.istate.mode=DICT2;case DICT2:if(0==z.avail_in)return r;r=f,z.avail_in--,z.total_in++,z.istate.need+=(255&z.next_in[z.next_in_index++])<<8&65280,z.istate.mode=DICT1;case DICT1:return 0==z.avail_in?r:(r=f,z.avail_in--,z.total_in++,z.istate.need+=255&z.next_in[z.next_in_index++],z.adler=z.istate.need,z.istate.mode=DICT0,Z_NEED_DICT);case DICT0:return z.istate.mode=BAD,z.msg="need dictionary",z.istate.marker=0,Z_STREAM_ERROR;case BLOCKS:if(r=z.istate.blocks.proc(z,r),r==Z_DATA_ERROR){z.istate.mode=BAD,z.istate.marker=0;break}if(r==Z_OK&&(r=f),r!=Z_STREAM_END)return r;if(r=f,z.istate.blocks.reset(z,z.istate.was),0!=z.istate.nowrap){z.istate.mode=DONE;break}z.istate.mode=CHECK4;case CHECK4:if(0==z.avail_in)return r;r=f,z.avail_in--,z.total_in++,z.istate.need=(255&z.next_in[z.next_in_index++])<<24&4278190080,z.istate.mode=CHECK3;case CHECK3:if(0==z.avail_in)return r;r=f,z.avail_in--,z.total_in++,z.istate.need+=(255&z.next_in[z.next_in_index++])<<16&16711680,z.istate.mode=CHECK2;case CHECK2:if(0==z.avail_in)return r;r=f,z.avail_in--,z.total_in++,z.istate.need+=(255&z.next_in[z.next_in_index++])<<8&65280,z.istate.mode=CHECK1;case CHECK1:if(0==z.avail_in)return r;if(r=f,z.avail_in--,z.total_in++,z.istate.need+=255&z.next_in[z.next_in_index++],z.istate.was[0]!=z.istate.need){z.istate.mode=BAD,z.msg="incorrect data check",z.istate.marker=5;break}z.istate.mode=DONE;case DONE:return Z_STREAM_END;case BAD:return Z_DATA_ERROR;default:return Z_STREAM_ERROR}},Inflate.prototype.inflateSetDictionary=function(z,dictionary,dictLength){var index=0,length=dictLength;return null==z||null==z.istate||z.istate.mode!=DICT0?Z_STREAM_ERROR:z._adler.adler32(1,dictionary,0,dictLength)!=z.adler?Z_DATA_ERROR:(z.adler=z._adler.adler32(0,null,0,0),length>=1<<z.istate.wbits&&(length=(1<<z.istate.wbits)-1,index=dictLength-length),z.istate.blocks.set_dictionary(dictionary,index,length),z.istate.mode=BLOCKS,Z_OK)};var mark=[0,0,255,255];Inflate.prototype.inflateSync=function(z){var n,p,m,r,w;if(null==z||null==z.istate)return Z_STREAM_ERROR;if(z.istate.mode!=BAD&&(z.istate.mode=BAD,z.istate.marker=0),0==(n=z.avail_in))return Z_BUF_ERROR;for(p=z.next_in_index,m=z.istate.marker;0!=n&&4>m;)z.next_in[p]==mark[m]?m++:m=0!=z.next_in[p]?0:4-m,p++,n--;return z.total_in+=p-z.next_in_index,z.next_in_index=p,z.avail_in=n,z.istate.marker=m,4!=m?Z_DATA_ERROR:(r=z.total_in,w=z.total_out,this.inflateReset(z),z.total_in=r,z.total_out=w,z.istate.mode=BLOCKS,Z_OK)},Inflate.prototype.inflateSyncPoint=function(z){return null==z||null==z.istate||null==z.istate.blocks?Z_STREAM_ERROR:z.istate.blocks.sync_point()};var INFBLOCKS_BORDER=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];InfBlocks.prototype.reset=function(z,c){c&&(c[0]=this.check),this.mode==IB_CODES&&this.codes.free(z),this.mode=IB_TYPE,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(z.adler=this.check=z._adler.adler32(0,null,0,0))},InfBlocks.prototype.proc=function(z,r){var t,b,k,p,n,q,m;for(p=z.next_in_index,n=z.avail_in,b=this.bitb,k=this.bitk,q=this.write,m=q<this.read?this.read-q-1:this.end-q;;)switch(this.mode){case IB_TYPE:for(;3>k;){if(0==n)return this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}switch(t=7&b,this.last=1&t,t>>>1){case 0:b>>>=3,k-=3,t=7&k,b>>>=t,k-=t,this.mode=IB_LENS;break;case 1:var bl=new Int32Array(1),bd=new Int32Array(1),tl=[],td=[];inflate_trees_fixed(bl,bd,tl,td,z),this.codes.init(bl[0],bd[0],tl[0],0,td[0],0,z),b>>>=3,k-=3,this.mode=IB_CODES;break;case 2:b>>>=3,k-=3,this.mode=IB_TABLE;break;case 3:return b>>>=3,k-=3,this.mode=BAD,z.msg="invalid block type",r=Z_DATA_ERROR,this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r)}break;case IB_LENS:for(;32>k;){if(0==n)return this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}if((~b>>>16&65535)!=(65535&b))return this.mode=BAD,z.msg="invalid stored block lengths",r=Z_DATA_ERROR,this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);this.left=65535&b,b=k=0,this.mode=0!=this.left?IB_STORED:0!=this.last?IB_DRY:IB_TYPE;break;case IB_STORED:if(0==n)return this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,write=q,this.inflate_flush(z,r);if(0==m&&(q==this.end&&0!=this.read&&(q=0,m=q<this.read?this.read-q-1:this.end-q),0==m&&(this.write=q,r=this.inflate_flush(z,r),q=this.write,m=q<this.read?this.read-q-1:this.end-q,q==this.end&&0!=this.read&&(q=0,m=q<this.read?this.read-q-1:this.end-q),0==m)))return this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);if(r=Z_OK,t=this.left,t>n&&(t=n),t>m&&(t=m),arrayCopy(z.next_in,p,this.window,q,t),p+=t,n-=t,q+=t,m-=t,0!=(this.left-=t))break;this.mode=0!=this.last?IB_DRY:IB_TYPE;break;case IB_TABLE:for(;14>k;){if(0==n)return this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}if(this.table=t=16383&b,(31&t)>29||(t>>5&31)>29)return this.mode=IB_BAD,z.msg="too many length or distance symbols",r=Z_DATA_ERROR,this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);if(t=258+(31&t)+(t>>5&31),null==this.blens||this.blens.length<t)this.blens=new Int32Array(t);else for(var i=0;t>i;i++)this.blens[i]=0;b>>>=14,k-=14,this.index=0,mode=IB_BTREE;case IB_BTREE:for(;this.index<4+(this.table>>>10);){for(;3>k;){if(0==n)return this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}this.blens[INFBLOCKS_BORDER[this.index++]]=7&b,b>>>=3,k-=3}for(;this.index<19;)this.blens[INFBLOCKS_BORDER[this.index++]]=0;if(this.bb[0]=7,t=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,z),t!=Z_OK)return r=t,r==Z_DATA_ERROR&&(this.blens=null,this.mode=IB_BAD),this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,write=q,this.inflate_flush(z,r);this.index=0,this.mode=IB_DTREE;case IB_DTREE:for(;;){if(t=this.table,!(this.index<258+(31&t)+(t>>5&31)))break;var i,j,c;for(t=this.bb[0];t>k;){if(0==n)return this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}if(t=this.hufts[3*(this.tb[0]+(b&inflate_mask[t]))+1],c=this.hufts[3*(this.tb[0]+(b&inflate_mask[t]))+2],16>c)b>>>=t,k-=t,this.blens[this.index++]=c;else{for(i=18==c?7:c-14,j=18==c?11:3;t+i>k;){if(0==n)return this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}if(b>>>=t,k-=t,j+=b&inflate_mask[i],b>>>=i,k-=i,i=this.index,t=this.table,i+j>258+(31&t)+(t>>5&31)||16==c&&1>i)return this.blens=null,this.mode=IB_BAD,z.msg="invalid bit length repeat",r=Z_DATA_ERROR,this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);c=16==c?this.blens[i-1]:0;do this.blens[i++]=c;while(0!=--j);this.index=i}}this.tb[0]=-1;var bl=new Int32Array(1),bd=new Int32Array(1),tl=new Int32Array(1),td=new Int32Array(1);if(bl[0]=9,bd[0]=6,t=this.table,t=this.inftree.inflate_trees_dynamic(257+(31&t),1+(t>>5&31),this.blens,bl,bd,tl,td,this.hufts,z),t!=Z_OK)return t==Z_DATA_ERROR&&(this.blens=null,this.mode=BAD),r=t,this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);this.codes.init(bl[0],bd[0],this.hufts,tl[0],this.hufts,td[0],z),this.mode=IB_CODES;case IB_CODES:if(this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,(r=this.codes.proc(this,z,r))!=Z_STREAM_END)return this.inflate_flush(z,r);if(r=Z_OK,this.codes.free(z),p=z.next_in_index,n=z.avail_in,b=this.bitb,k=this.bitk,q=this.write,m=q<this.read?this.read-q-1:this.end-q,0==this.last){this.mode=IB_TYPE;break}this.mode=IB_DRY;case IB_DRY:if(this.write=q,r=this.inflate_flush(z,r),q=this.write,m=q<this.read?this.read-q-1:this.end-q,this.read!=this.write)return this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);mode=DONE;case IB_DONE:return r=Z_STREAM_END,this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);case IB_BAD:return r=Z_DATA_ERROR,this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r);default:return r=Z_STREAM_ERROR,this.bitb=b,this.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,this.write=q,this.inflate_flush(z,r)}},InfBlocks.prototype.free=function(z){this.reset(z,null),this.window=null,this.hufts=null},InfBlocks.prototype.set_dictionary=function(d,start,n){arrayCopy(d,start,this.window,0,n),this.read=this.write=n},InfBlocks.prototype.sync_point=function(){return this.mode==IB_LENS},InfBlocks.prototype.inflate_flush=function(z,r){var n,p,q;return p=z.next_out_index,q=this.read,n=(q<=this.write?this.write:this.end)-q,n>z.avail_out&&(n=z.avail_out),0!=n&&r==Z_BUF_ERROR&&(r=Z_OK),z.avail_out-=n,z.total_out+=n,null!=this.checkfn&&(z.adler=this.check=z._adler.adler32(this.check,this.window,q,n)),arrayCopy(this.window,q,z.next_out,p,n),p+=n,q+=n,q==this.end&&(q=0,this.write==this.end&&(this.write=0),n=this.write-q,n>z.avail_out&&(n=z.avail_out),0!=n&&r==Z_BUF_ERROR&&(r=Z_OK),z.avail_out-=n,z.total_out+=n,null!=this.checkfn&&(z.adler=this.check=z._adler.adler32(this.check,this.window,q,n)),arrayCopy(this.window,q,z.next_out,p,n),p+=n,q+=n),z.next_out_index=p,this.read=q,r};var IC_START=0,IC_LEN=1,IC_LENEXT=2,IC_DIST=3,IC_DISTEXT=4,IC_COPY=5,IC_LIT=6,IC_WASH=7,IC_END=8,IC_BADCODE=9;InfCodes.prototype.init=function(bl,bd,tl,tl_index,td,td_index,z){this.mode=IC_START,this.lbits=bl,this.dbits=bd,this.ltree=tl,this.ltree_index=tl_index,this.dtree=td,this.dtree_index=td_index,this.tree=null},InfCodes.prototype.proc=function(s,z,r){var j,tindex,e,n,q,m,f,b=0,k=0,p=0;for(p=z.next_in_index,n=z.avail_in,b=s.bitb,k=s.bitk,q=s.write,m=q<s.read?s.read-q-1:s.end-q;;)switch(this.mode){case IC_START:if(m>=258&&n>=10&&(s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,r=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,s,z),p=z.next_in_index,n=z.avail_in,b=s.bitb,k=s.bitk,q=s.write,m=q<s.read?s.read-q-1:s.end-q,r!=Z_OK)){this.mode=r==Z_STREAM_END?IC_WASH:IC_BADCODE;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=IC_LEN;case IC_LEN:for(j=this.need;j>k;){if(0==n)return s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}if(tindex=3*(this.tree_index+(b&inflate_mask[j])),b>>>=this.tree[tindex+1],k-=this.tree[tindex+1],e=this.tree[tindex],0==e){this.lit=this.tree[tindex+2],this.mode=IC_LIT;break}if(0!=(16&e)){this.get=15&e,this.len=this.tree[tindex+2],this.mode=IC_LENEXT;break}if(0==(64&e)){this.need=e,this.tree_index=tindex/3+this.tree[tindex+2];break}if(0!=(32&e)){this.mode=IC_WASH;break}return this.mode=IC_BADCODE,z.msg="invalid literal/length code",r=Z_DATA_ERROR,s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);case IC_LENEXT:for(j=this.get;j>k;){if(0==n)return s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}this.len+=b&inflate_mask[j],b>>=j,k-=j,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=IC_DIST;case IC_DIST:for(j=this.need;j>k;){if(0==n)return s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}if(tindex=3*(this.tree_index+(b&inflate_mask[j])),b>>=this.tree[tindex+1],k-=this.tree[tindex+1],e=this.tree[tindex],0!=(16&e)){this.get=15&e,this.dist=this.tree[tindex+2],this.mode=IC_DISTEXT;break}if(0==(64&e)){this.need=e,this.tree_index=tindex/3+this.tree[tindex+2];break}return this.mode=IC_BADCODE,z.msg="invalid distance code",r=Z_DATA_ERROR,s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);case IC_DISTEXT:for(j=this.get;j>k;){if(0==n)return s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);r=Z_OK,n--,b|=(255&z.next_in[p++])<<k,k+=8}this.dist+=b&inflate_mask[j],b>>=j,k-=j,this.mode=IC_COPY;case IC_COPY:for(f=q-this.dist;0>f;)f+=s.end;for(;0!=this.len;){if(0==m&&(q==s.end&&0!=s.read&&(q=0,m=q<s.read?s.read-q-1:s.end-q),0==m&&(s.write=q,r=s.inflate_flush(z,r),q=s.write,m=q<s.read?s.read-q-1:s.end-q,q==s.end&&0!=s.read&&(q=0,m=q<s.read?s.read-q-1:s.end-q),0==m)))return s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);s.window[q++]=s.window[f++],m--,f==s.end&&(f=0),this.len--}this.mode=IC_START;break;case IC_LIT:if(0==m&&(q==s.end&&0!=s.read&&(q=0,m=q<s.read?s.read-q-1:s.end-q),0==m&&(s.write=q,r=s.inflate_flush(z,r),q=s.write,m=q<s.read?s.read-q-1:s.end-q,q==s.end&&0!=s.read&&(q=0,m=q<s.read?s.read-q-1:s.end-q),0==m)))return s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);r=Z_OK,s.window[q++]=this.lit,m--,this.mode=IC_START;break;case IC_WASH:if(k>7&&(k-=8,n++,p--),s.write=q,r=s.inflate_flush(z,r),q=s.write,m=q<s.read?s.read-q-1:s.end-q,s.read!=s.write)return s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);this.mode=IC_END;case IC_END:return r=Z_STREAM_END,s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);case IC_BADCODE:return r=Z_DATA_ERROR,s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r);default:return r=Z_STREAM_ERROR,s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,s.inflate_flush(z,r)}},InfCodes.prototype.free=function(z){},InfCodes.prototype.inflate_fast=function(bl,bd,tl,tl_index,td,td_index,s,z){var t,tp,tp_index,e,b,k,p,n,q,m,ml,md,c,d,r,tp_index_t_3;p=z.next_in_index,n=z.avail_in,b=s.bitb,k=s.bitk,q=s.write,m=q<s.read?s.read-q-1:s.end-q,ml=inflate_mask[bl],md=inflate_mask[bd];do{for(;20>k;)n--,b|=(255&z.next_in[p++])<<k,k+=8;if(t=b&ml,tp=tl,tp_index=tl_index,tp_index_t_3=3*(tp_index+t),0!=(e=tp[tp_index_t_3]))for(;;){if(b>>=tp[tp_index_t_3+1],k-=tp[tp_index_t_3+1],0!=(16&e)){for(e&=15,c=tp[tp_index_t_3+2]+(b&inflate_mask[e]),b>>=e,k-=e;15>k;)n--,b|=(255&z.next_in[p++])<<k,k+=8;for(t=b&md,tp=td,tp_index=td_index,tp_index_t_3=3*(tp_index+t),e=tp[tp_index_t_3];;){if(b>>=tp[tp_index_t_3+1],k-=tp[tp_index_t_3+1],0!=(16&e)){for(e&=15;e>k;)n--,b|=(255&z.next_in[p++])<<k,k+=8;if(d=tp[tp_index_t_3+2]+(b&inflate_mask[e]),b>>=e,k-=e,m-=c,q>=d)r=q-d,q-r>0&&2>q-r?(s.window[q++]=s.window[r++],s.window[q++]=s.window[r++],c-=2):(s.window[q++]=s.window[r++],s.window[q++]=s.window[r++],c-=2);else{r=q-d;do r+=s.end;while(0>r);if(e=s.end-r,c>e){if(c-=e,q-r>0&&e>q-r){do s.window[q++]=s.window[r++];while(0!=--e)}else arrayCopy(s.window,r,s.window,q,e),q+=e,r+=e,e=0;r=0}}do s.window[q++]=s.window[r++];while(0!=--c);break}if(0!=(64&e))return z.msg="invalid distance code",c=z.avail_in-n,c=c>k>>3?k>>3:c,n+=c,p-=c,k-=c<<3,s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,
z.next_in_index=p,s.write=q,Z_DATA_ERROR;t+=tp[tp_index_t_3+2],t+=b&inflate_mask[e],tp_index_t_3=3*(tp_index+t),e=tp[tp_index_t_3]}break}if(0!=(64&e))return 0!=(32&e)?(c=z.avail_in-n,c=c>k>>3?k>>3:c,n+=c,p-=c,k-=c<<3,s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,Z_STREAM_END):(z.msg="invalid literal/length code",c=z.avail_in-n,c=c>k>>3?k>>3:c,n+=c,p-=c,k-=c<<3,s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,Z_DATA_ERROR);if(t+=tp[tp_index_t_3+2],t+=b&inflate_mask[e],tp_index_t_3=3*(tp_index+t),0==(e=tp[tp_index_t_3])){b>>=tp[tp_index_t_3+1],k-=tp[tp_index_t_3+1],s.window[q++]=tp[tp_index_t_3+2],m--;break}}else b>>=tp[tp_index_t_3+1],k-=tp[tp_index_t_3+1],s.window[q++]=tp[tp_index_t_3+2],m--}while(m>=258&&n>=10);return c=z.avail_in-n,c=c>k>>3?k>>3:c,n+=c,p-=c,k-=c<<3,s.bitb=b,s.bitk=k,z.avail_in=n,z.total_in+=p-z.next_in_index,z.next_in_index=p,s.write=q,Z_OK},InfTree.prototype.huft_build=function(b,bindex,n,s,d,e,t,m,hp,hn,v){var a,f,g,h,i,j,k,l,mask,p,q,w,xp,y,z;p=0,i=n;do this.c[b[bindex+p]]++,p++,i--;while(0!=i);if(this.c[0]==n)return t[0]=-1,m[0]=0,Z_OK;for(l=m[0],j=1;BMAX>=j&&0==this.c[j];j++);for(k=j,j>l&&(l=j),i=BMAX;0!=i&&0==this.c[i];i--);for(g=i,l>i&&(l=i),m[0]=l,y=1<<j;i>j;j++,y<<=1)if((y-=this.c[j])<0)return Z_DATA_ERROR;if((y-=this.c[i])<0)return Z_DATA_ERROR;for(this.c[i]+=y,this.x[1]=j=0,p=1,xp=2;0!=--i;)this.x[xp]=j+=this.c[p],xp++,p++;i=0,p=0;do 0!=(j=b[bindex+p])&&(this.v[this.x[j]++]=i),p++;while(++i<n);for(n=this.x[g],this.x[0]=i=0,p=0,h=-1,w=-l,this.u[0]=0,q=0,z=0;g>=k;k++)for(a=this.c[k];0!=a--;){for(;k>w+l;){if(h++,w+=l,z=g-w,z=z>l?l:z,(f=1<<(j=k-w))>a+1&&(f-=a+1,xp=k,z>j))for(;++j<z&&!((f<<=1)<=this.c[++xp]);)f-=this.c[xp];if(z=1<<j,this.hn[0]+z>MANY)return Z_DATA_ERROR;this.u[h]=q=this.hn[0],this.hn[0]+=z,0!=h?(this.x[h]=i,this.r[0]=j,this.r[1]=l,j=i>>>w-l,this.r[2]=q-this.u[h-1]-j,arrayCopy(this.r,0,hp,3*(this.u[h-1]+j),3)):t[0]=q}for(this.r[1]=k-w,p>=n?this.r[0]=192:v[p]<s?(this.r[0]=this.v[p]<256?0:96,this.r[2]=this.v[p++]):(this.r[0]=e[this.v[p]-s]+16+64,this.r[2]=d[this.v[p++]-s]),f=1<<k-w,j=i>>>w;z>j;j+=f)arrayCopy(this.r,0,hp,3*(q+j),3);for(j=1<<k-1;0!=(i&j);j>>>=1)i^=j;for(i^=j,mask=(1<<w)-1;(i&mask)!=this.x[h];)h--,w-=l,mask=(1<<w)-1}return 0!=y&&1!=g?Z_BUF_ERROR:Z_OK},InfTree.prototype.inflate_trees_bits=function(c,bb,tb,hp,z){var result;return this.initWorkArea(19),this.hn[0]=0,result=this.huft_build(c,0,19,19,null,null,tb,bb,hp,this.hn,this.v),result==Z_DATA_ERROR?z.msg="oversubscribed dynamic bit lengths tree":result!=Z_BUF_ERROR&&0!=bb[0]||(z.msg="incomplete dynamic bit lengths tree",result=Z_DATA_ERROR),result},InfTree.prototype.inflate_trees_dynamic=function(nl,nd,c,bl,bd,tl,td,hp,z){var result;return this.initWorkArea(288),this.hn[0]=0,result=this.huft_build(c,0,nl,257,cplens,cplext,tl,bl,hp,this.hn,this.v),result!=Z_OK||0==bl[0]?(result==Z_DATA_ERROR?z.msg="oversubscribed literal/length tree":result!=Z_MEM_ERROR&&(z.msg="incomplete literal/length tree",result=Z_DATA_ERROR),result):(this.initWorkArea(288),result=this.huft_build(c,nl,nd,0,cpdist,cpdext,td,bd,hp,this.hn,this.v),result!=Z_OK||0==bd[0]&&nl>257?(result==Z_DATA_ERROR?z.msg="oversubscribed distance tree":result==Z_BUF_ERROR?(z.msg="incomplete distance tree",result=Z_DATA_ERROR):result!=Z_MEM_ERROR&&(z.msg="empty distance tree with lengths",result=Z_DATA_ERROR),result):Z_OK)},InfTree.prototype.initWorkArea=function(vsize){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(vsize),this.c=new Int32Array(BMAX+1),this.r=new Int32Array(3),this.u=new Int32Array(BMAX),this.x=new Int32Array(BMAX+1)),this.v.length<vsize&&(this.v=new Int32Array(vsize));for(var i=0;vsize>i;i++)this.v[i]=0;for(var i=0;BMAX+1>i;i++)this.c[i]=0;for(var i=0;3>i;i++)this.r[i]=0;arrayCopy(this.c,0,this.u,0,BMAX),arrayCopy(this.c,0,this.x,0,BMAX+1)};var testArray=new Uint8Array(1),hasSubarray="function"==typeof testArray.subarray,hasSlice=!1,ADLER_BASE=65521,ADLER_NMAX=5552;!function(global){"use strict";function arrayFrom(arrayLike,forceCopy){return!forceCopy&&arrayLike instanceof Array?arrayLike:Array.prototype.slice.call(arrayLike)}function defined(value,defaultValue){return void 0!==value?value:defaultValue}function jDataView(buffer,byteOffset,byteLength,littleEndian){if(buffer instanceof jDataView){var result=buffer.slice(byteOffset,byteOffset+byteLength);return result._littleEndian=defined(littleEndian,result._littleEndian),result}if(!(this instanceof jDataView))return new jDataView(buffer,byteOffset,byteLength,littleEndian);if(this.buffer=buffer=jDataView.wrapBuffer(buffer),this._isArrayBuffer=compatibility.ArrayBuffer&&buffer instanceof ArrayBuffer,this._isPixelData=compatibility.PixelData&&buffer instanceof CanvasPixelArray,this._isDataView=compatibility.DataView&&this._isArrayBuffer,this._isNodeBuffer=compatibility.NodeBuffer&&buffer instanceof Buffer,!(this._isNodeBuffer||this._isArrayBuffer||this._isPixelData||buffer instanceof Array))throw new TypeError("jDataView buffer has an incompatible type");this._littleEndian=!!littleEndian;var bufferLength="byteLength"in buffer?buffer.byteLength:buffer.length;this.byteOffset=byteOffset=defined(byteOffset,0),this.byteLength=byteLength=defined(byteLength,bufferLength-byteOffset),this._isDataView?this._view=new DataView(buffer,byteOffset,byteLength):this._checkBounds(byteOffset,byteLength,bufferLength),this._engineAction=this._isDataView?this._dataViewAction:this._isNodeBuffer?this._nodeBufferAction:this._isArrayBuffer?this._arrayBufferAction:this._arrayAction}function getCharCodes(string){if(compatibility.NodeBuffer)return new Buffer(string,"binary");for(var Type=compatibility.ArrayBuffer?Uint8Array:Array,codes=new Type(string.length),i=0,length=string.length;length>i;i++)codes[i]=255&string.charCodeAt(i);return codes}function pow2(n){return n>=0&&31>n?1<<n:pow2[n]||(pow2[n]=Math.pow(2,n))}function Uint64(lo,hi){this.lo=lo,this.hi=hi}function Int64(lo,hi){Uint64.apply(this,arguments)}var compatibility={NodeBuffer:"Buffer"in global&&"readInt16LE"in Buffer.prototype,DataView:"DataView"in global&&("getFloat64"in DataView.prototype||"getFloat64"in new DataView(new ArrayBuffer(1))),ArrayBuffer:"ArrayBuffer"in global,PixelData:"CanvasPixelArray"in global&&"ImageData"in global&&"document"in global};if(compatibility.NodeBuffer&&!function(buffer){try{buffer.writeFloatLE(1/0,0)}catch(e){compatibility.NodeBuffer=!1}}(new Buffer(4)),compatibility.PixelData){var createPixelData=function(byteLength,buffer){var data=createPixelData.context2d.createImageData((byteLength+3)/4,1).data;if(data.byteLength=byteLength,void 0!==buffer)for(var i=0;byteLength>i;i++)data[i]=buffer[i];return data};createPixelData.context2d=document.createElement("canvas").getContext("2d")}var dataTypes={Int8:1,Int16:2,Int32:4,Uint8:1,Uint16:2,Uint32:4,Float32:4,Float64:8},nodeNaming={Int8:"Int8",Int16:"Int16",Int32:"Int32",Uint8:"UInt8",Uint16:"UInt16",Uint32:"UInt32",Float32:"Float",Float64:"Double"};jDataView.wrapBuffer=function(buffer){switch(typeof buffer){case"number":if(compatibility.NodeBuffer)buffer=new Buffer(buffer),buffer.fill(0);else if(compatibility.ArrayBuffer)buffer=new Uint8Array(buffer).buffer;else if(compatibility.PixelData)buffer=createPixelData(buffer);else{buffer=new Array(buffer);for(var i=0;i<buffer.length;i++)buffer[i]=0}return buffer;case"string":buffer=getCharCodes(buffer);default:return"length"in buffer&&!(compatibility.NodeBuffer&&buffer instanceof Buffer||compatibility.ArrayBuffer&&buffer instanceof ArrayBuffer||compatibility.PixelData&&buffer instanceof CanvasPixelArray)&&(compatibility.NodeBuffer?buffer=new Buffer(buffer):compatibility.ArrayBuffer?buffer instanceof ArrayBuffer||(buffer=new Uint8Array(buffer).buffer,buffer instanceof ArrayBuffer||(buffer=new Uint8Array(arrayFrom(buffer,!0)).buffer)):buffer=compatibility.PixelData?createPixelData(buffer.length,buffer):arrayFrom(buffer)),buffer}},jDataView.createBuffer=function(){return jDataView.wrapBuffer(arguments)},jDataView.Uint64=Uint64,Uint64.prototype={valueOf:function(){return this.lo+pow2(32)*this.hi},toString:function(){return Number.prototype.toString.apply(this.valueOf(),arguments)}},Uint64.fromNumber=function(number){var hi=Math.floor(number/pow2(32)),lo=number-hi*pow2(32);return new Uint64(lo,hi)},jDataView.Int64=Int64,Int64.prototype="create"in Object?Object.create(Uint64.prototype):new Uint64,Int64.prototype.valueOf=function(){return this.hi<pow2(31)?Uint64.prototype.valueOf.apply(this,arguments):-(pow2(32)-this.lo+pow2(32)*(pow2(32)-1-this.hi))},Int64.fromNumber=function(number){var lo,hi;if(number>=0){var unsigned=Uint64.fromNumber(number);lo=unsigned.lo,hi=unsigned.hi}else hi=Math.floor(number/pow2(32)),lo=number-hi*pow2(32),hi+=pow2(32);return new Int64(lo,hi)},jDataView.prototype={_offset:0,_bitOffset:0,compatibility:compatibility,_checkBounds:function(byteOffset,byteLength,maxLength){if("number"!=typeof byteOffset)throw new TypeError("Offset is not a number.");if("number"!=typeof byteLength)throw new TypeError("Size is not a number.");if(0>byteLength)throw new RangeError("Length is negative.");if(0>byteOffset||byteOffset+byteLength>defined(maxLength,this.byteLength))throw new RangeError("Offsets are out of bounds.")},_action:function(type,isReadAction,byteOffset,littleEndian,value){return this._engineAction(type,isReadAction,defined(byteOffset,this._offset),defined(littleEndian,this._littleEndian),value)},_dataViewAction:function(type,isReadAction,byteOffset,littleEndian,value){this._offset=byteOffset+dataTypes[type];try{return isReadAction?this._view["get"+type](byteOffset,littleEndian):this._view["set"+type](byteOffset,value,littleEndian)}catch(x){throw x}},_nodeBufferAction:function(type,isReadAction,byteOffset,littleEndian,value){this._offset=byteOffset+dataTypes[type];var nodeName=nodeNaming[type]+("Int8"===type||"Uint8"===type?"":littleEndian?"LE":"BE");return byteOffset+=this.byteOffset,isReadAction?this.buffer["read"+nodeName](byteOffset):this.buffer["write"+nodeName](value,byteOffset)},_arrayBufferAction:function(type,isReadAction,byteOffset,littleEndian,value){var typedArray,size=dataTypes[type],TypedArray=global[type+"Array"];if(littleEndian=defined(littleEndian,this._littleEndian),1===size||(this.byteOffset+byteOffset)%size===0&&littleEndian)return typedArray=new TypedArray(this.buffer,this.byteOffset+byteOffset,1),this._offset=byteOffset+size,isReadAction?typedArray[0]:typedArray[0]=value;var bytes=new Uint8Array(isReadAction?this.getBytes(size,byteOffset,littleEndian,!0):size);return typedArray=new TypedArray(bytes.buffer,0,1),isReadAction?typedArray[0]:(typedArray[0]=value,void this._setBytes(byteOffset,bytes,littleEndian))},_arrayAction:function(type,isReadAction,byteOffset,littleEndian,value){return isReadAction?this["_get"+type](byteOffset,littleEndian):this["_set"+type](byteOffset,value,littleEndian)},_getBytes:function(length,byteOffset,littleEndian){littleEndian=defined(littleEndian,this._littleEndian),byteOffset=defined(byteOffset,this._offset),length=defined(length,this.byteLength-byteOffset),this._checkBounds(byteOffset,length),byteOffset+=this.byteOffset,this._offset=byteOffset-this.byteOffset+length;var result=this._isArrayBuffer?new Uint8Array(this.buffer,byteOffset,length):(this.buffer.slice||Array.prototype.slice).call(this.buffer,byteOffset,byteOffset+length);return littleEndian||1>=length?result:arrayFrom(result).reverse()},getBytes:function(length,byteOffset,littleEndian,toArray){var result=this._getBytes(length,byteOffset,defined(littleEndian,!0));return toArray?arrayFrom(result):result},_setBytes:function(byteOffset,bytes,littleEndian){var length=bytes.length;if(0!==length){if(littleEndian=defined(littleEndian,this._littleEndian),byteOffset=defined(byteOffset,this._offset),this._checkBounds(byteOffset,length),!littleEndian&&length>1&&(bytes=arrayFrom(bytes,!0).reverse()),byteOffset+=this.byteOffset,this._isArrayBuffer)new Uint8Array(this.buffer,byteOffset,length).set(bytes);else if(this._isNodeBuffer)new Buffer(bytes).copy(this.buffer,byteOffset);else for(var i=0;length>i;i++)this.buffer[byteOffset+i]=bytes[i];this._offset=byteOffset-this.byteOffset+length}},setBytes:function(byteOffset,bytes,littleEndian){this._setBytes(byteOffset,bytes,defined(littleEndian,!0))},getString:function(byteLength,byteOffset,encoding){if(this._isNodeBuffer)return byteOffset=defined(byteOffset,this._offset),byteLength=defined(byteLength,this.byteLength-byteOffset),this._checkBounds(byteOffset,byteLength),this._offset=byteOffset+byteLength,this.buffer.toString(encoding||"binary",this.byteOffset+byteOffset,this.byteOffset+this._offset);var bytes=this._getBytes(byteLength,byteOffset,!0),string="";byteLength=bytes.length;for(var i=0;byteLength>i;i++)string+=String.fromCharCode(bytes[i]);return"utf8"===encoding&&(string=decodeURIComponent(escape(string))),string},setString:function(byteOffset,subString,encoding){return this._isNodeBuffer?(byteOffset=defined(byteOffset,this._offset),this._checkBounds(byteOffset,subString.length),void(this._offset=byteOffset+this.buffer.write(subString,this.byteOffset+byteOffset,encoding||"binary"))):("utf8"===encoding&&(subString=unescape(encodeURIComponent(subString))),void this._setBytes(byteOffset,getCharCodes(subString),!0))},getChar:function(byteOffset){return this.getString(1,byteOffset)},setChar:function(byteOffset,character){this.setString(byteOffset,character)},tell:function(){return this._offset},seek:function(byteOffset){return this._checkBounds(byteOffset,0),this._offset=byteOffset},skip:function(byteLength){return this.seek(this._offset+byteLength)},slice:function(start,end,forceCopy){function normalizeOffset(offset,byteLength){return 0>offset?offset+byteLength:offset}return start=normalizeOffset(start,this.byteLength),end=normalizeOffset(defined(end,this.byteLength),this.byteLength),forceCopy?new jDataView(this.getBytes(end-start,start,!0,!0),void 0,void 0,this._littleEndian):new jDataView(this.buffer,this.byteOffset+start,end-start,this._littleEndian)},alignBy:function(byteCount){return this._bitOffset=0,1!==defined(byteCount,1)?this.skip(byteCount-(this._offset%byteCount||byteCount)):this._offset},_getFloat64:function(byteOffset,littleEndian){var b=this._getBytes(8,byteOffset,littleEndian),sign=1-2*(b[7]>>7),exponent=((b[7]<<1&255)<<3|b[6]>>4)-1023,mantissa=(15&b[6])*pow2(48)+b[5]*pow2(40)+b[4]*pow2(32)+b[3]*pow2(24)+b[2]*pow2(16)+b[1]*pow2(8)+b[0];return 1024===exponent?0!==mantissa?NaN:sign*(1/0):-1023===exponent?sign*mantissa*pow2(-1074):sign*(1+mantissa*pow2(-52))*pow2(exponent)},_getFloat32:function(byteOffset,littleEndian){var b=this._getBytes(4,byteOffset,littleEndian),sign=1-2*(b[3]>>7),exponent=(b[3]<<1&255|b[2]>>7)-127,mantissa=(127&b[2])<<16|b[1]<<8|b[0];return 128===exponent?0!==mantissa?NaN:sign*(1/0):-127===exponent?sign*mantissa*pow2(-149):sign*(1+mantissa*pow2(-23))*pow2(exponent)},_get64:function(Type,byteOffset,littleEndian){littleEndian=defined(littleEndian,this._littleEndian),byteOffset=defined(byteOffset,this._offset);for(var parts=littleEndian?[0,4]:[4,0],i=0;2>i;i++)parts[i]=this.getUint32(byteOffset+parts[i],littleEndian);return this._offset=byteOffset+8,new Type(parts[0],parts[1])},getInt64:function(byteOffset,littleEndian){return this._get64(Int64,byteOffset,littleEndian)},getUint64:function(byteOffset,littleEndian){return this._get64(Uint64,byteOffset,littleEndian)},_getInt32:function(byteOffset,littleEndian){var b=this._getBytes(4,byteOffset,littleEndian);return b[3]<<24|b[2]<<16|b[1]<<8|b[0]},_getUint32:function(byteOffset,littleEndian){return this._getInt32(byteOffset,littleEndian)>>>0},_getInt16:function(byteOffset,littleEndian){return this._getUint16(byteOffset,littleEndian)<<16>>16},_getUint16:function(byteOffset,littleEndian){var b=this._getBytes(2,byteOffset,littleEndian);return b[1]<<8|b[0]},_getInt8:function(byteOffset){return this._getUint8(byteOffset)<<24>>24},_getUint8:function(byteOffset){return this._getBytes(1,byteOffset)[0]},_getBitRangeData:function(bitLength,byteOffset){var startBit=(defined(byteOffset,this._offset)<<3)+this._bitOffset,endBit=startBit+bitLength,start=startBit>>>3,end=endBit+7>>>3,b=this._getBytes(end-start,start,!0),wideValue=0;(this._bitOffset=7&endBit)&&(this._bitOffset-=8);for(var i=0,length=b.length;length>i;i++)wideValue=wideValue<<8|b[i];return{start:start,bytes:b,wideValue:wideValue}},getSigned:function(bitLength,byteOffset){var shift=32-bitLength;return this.getUnsigned(bitLength,byteOffset)<<shift>>shift},getUnsigned:function(bitLength,byteOffset){var value=this._getBitRangeData(bitLength,byteOffset).wideValue>>>-this._bitOffset;return 32>bitLength?value&~(-1<<bitLength):value},_setBinaryFloat:function(byteOffset,value,mantSize,expSize,littleEndian){var exponent,mantissa,signBit=0>value?1:0,eMax=~(-1<<expSize-1),eMin=1-eMax;0>value&&(value=-value),0===value?(exponent=0,mantissa=0):isNaN(value)?(exponent=2*eMax+1,mantissa=1):value===1/0?(exponent=2*eMax+1,mantissa=0):(exponent=Math.floor(Math.log(value)/Math.LN2),exponent>=eMin&&eMax>=exponent?(mantissa=Math.floor((value*pow2(-exponent)-1)*pow2(mantSize)),exponent+=eMax):(mantissa=Math.floor(value/pow2(eMin-mantSize)),exponent=0));for(var b=[];mantSize>=8;)b.push(mantissa%256),mantissa=Math.floor(mantissa/256),mantSize-=8;for(exponent=exponent<<mantSize|mantissa,expSize+=mantSize;expSize>=8;)b.push(255&exponent),exponent>>>=8,expSize-=8;b.push(signBit<<expSize|exponent),this._setBytes(byteOffset,b,littleEndian)},_setFloat32:function(byteOffset,value,littleEndian){this._setBinaryFloat(byteOffset,value,23,8,littleEndian)},_setFloat64:function(byteOffset,value,littleEndian){this._setBinaryFloat(byteOffset,value,52,11,littleEndian)},_set64:function(Type,byteOffset,value,littleEndian){value instanceof Type||(value=Type.fromNumber(value)),littleEndian=defined(littleEndian,this._littleEndian),byteOffset=defined(byteOffset,this._offset);var parts=littleEndian?{lo:0,hi:4}:{lo:4,hi:0};for(var partName in parts)this.setUint32(byteOffset+parts[partName],value[partName],littleEndian);this._offset=byteOffset+8},setInt64:function(byteOffset,value,littleEndian){this._set64(Int64,byteOffset,value,littleEndian)},setUint64:function(byteOffset,value,littleEndian){this._set64(Uint64,byteOffset,value,littleEndian)},_setUint32:function(byteOffset,value,littleEndian){this._setBytes(byteOffset,[255&value,value>>>8&255,value>>>16&255,value>>>24],littleEndian)},_setUint16:function(byteOffset,value,littleEndian){this._setBytes(byteOffset,[255&value,value>>>8&255],littleEndian)},_setUint8:function(byteOffset,value){this._setBytes(byteOffset,[255&value])},setUnsigned:function(byteOffset,value,bitLength){var data=this._getBitRangeData(bitLength,byteOffset),wideValue=data.wideValue,b=data.bytes;wideValue&=~(~(-1<<bitLength)<<-this._bitOffset),wideValue|=(32>bitLength?value&~(-1<<bitLength):value)<<-this._bitOffset;for(var i=b.length-1;i>=0;i--)b[i]=255&wideValue,wideValue>>>=8;this._setBytes(data.start,b,!0)}};var proto=jDataView.prototype;for(var type in dataTypes)!function(type){proto["get"+type]=function(byteOffset,littleEndian){return this._action(type,!0,byteOffset,littleEndian)},proto["set"+type]=function(byteOffset,value,littleEndian){this._action(type,!1,byteOffset,littleEndian,value)}}(type);proto._setInt32=proto._setUint32,proto._setInt16=proto._setUint16,proto._setInt8=proto._setUint8,proto.setSigned=proto.setUnsigned;for(var method in proto)"set"===method.slice(0,3)&&!function(type){proto["write"+type]=function(){Array.prototype.unshift.call(arguments,void 0),this["set"+type].apply(this,arguments)}}(method.slice(3));if("undefined"!=typeof module&&"object"==typeof module.exports)module.exports=jDataView;else if("function"==typeof define&&define.amd)define([],function(){return jDataView});else{var oldGlobal=global.jDataView;(global.jDataView=jDataView).noConflict=function(){return global.jDataView=oldGlobal,this}}}(function(){return this}()),function(){function inherit(obj){function ClonedObject(){}"create"in Object?obj=Object.create(obj):(ClonedObject.prototype=obj,obj=new ClonedObject);for(var i=1;i<arguments.length;++i){var source=arguments[i];for(var prop in source)void 0!==source[prop]&&(obj[prop]=source[prop])}return obj}function jParser(view,structure){if(!(this instanceof arguments.callee))throw new Error("Constructor may not be called as a function");view instanceof jDataView||(view=new jDataView(view,void 0,void 0,!0)),this.view=view,this.view.seek(0),this._bitShift=0,this.structure=inherit(jParser.prototype.structure,structure)}function toInt(val){return val instanceof Function?val.call(this):val}"undefined"==typeof jDataView&&"undefined"!=typeof require&&(jDataView=require("jDataView")),jParser.prototype.structure={uint8:function(){return this.view.getUint8()},uint16:function(){return this.view.getUint16()},uint32:function(){return this.view.getUint32()},int8:function(){return this.view.getInt8()},int16:function(){return this.view.getInt16()},int32:function(){return this.view.getInt32()},float32:function(){return this.view.getFloat32()},float64:function(){return this.view.getFloat64()},"char":function(){return this.view.getChar()},string:function(length){return this.view.getString(toInt.call(this,length))},array:function(type,length){length=toInt.call(this,length);for(var results=[],i=0;length>i;++i)results.push(this.parse(type));return results},seek:function(position,block){if(position=toInt.call(this,position),block instanceof Function){var old_position=this.view.tell();this.view.seek(position);var result=block.call(this);return this.view.seek(old_position),result}return this.view.seek(position)},tell:function(){return this.view.tell()},skip:function(offset){return offset=toInt.call(this,offset),this.view.seek(this.view.tell()+offset),offset},"if":function(predicate){return(predicate instanceof Function?predicate.call(this):predicate)?this.parse.apply(this,Array.prototype.slice.call(arguments,1)):void 0}},jParser.prototype.seek=jParser.prototype.structure.seek,jParser.prototype.tell=jParser.prototype.structure.tell,jParser.prototype.skip=jParser.prototype.structure.skip,jParser.prototype.parse=function(structure){if("number"==typeof structure){var fieldValue=0,bitSize=structure;if(this._bitShift<0){var byteShift=this._bitShift>>3;this.skip(byteShift),this._bitShift&=7}for(this._bitShift>0&&bitSize>=8-this._bitShift&&(fieldValue=this.view.getUint8()&~(-1<<8-this._bitShift),bitSize-=8-this._bitShift,this._bitShift=0);bitSize>=8;)fieldValue=this.view.getUint8()|fieldValue<<8,bitSize-=8;return bitSize>0&&(fieldValue=this.view.getUint8()>>>8-(this._bitShift+bitSize)&~(-1<<bitSize)|fieldValue<<bitSize,this._bitShift+=bitSize-8),fieldValue}if(structure instanceof Function)return structure.apply(this,Array.prototype.slice.call(arguments,1));if("string"==typeof structure&&(structure=Array.prototype.slice.call(arguments)),structure instanceof Array){var key=structure[0];if(!(key in this.structure))throw new Error("Missing structure for `"+key+"`");return this.parse.apply(this,[this.structure[key]].concat(structure.slice(1)))}if("object"==typeof structure){var output={},current=this.current;this.current=output;for(var key in structure){var value=this.parse(structure[key]);void 0!==value&&(output[key]=value)}return this.current=current,output}throw new Error("Unknown structure type `"+structure+"`")};var all;"undefined"!=typeof self?all=self:"undefined"!=typeof window?all=window:"undefined"!=typeof global&&(all=global),all.jParser=jParser,"undefined"!=typeof module&&(module.exports=jParser)}();var start16kbBinid=4681,end16kbBinid=37449,_16KB=16384,_65kb=Math.pow(2,16),MAX_BIN=37449,bgzf_hd_fmt={header:{id1:"uint8",id2:"uint8",cm:"uint8",flg:"uint8",mtime:"uint32",xfl:"uint8",os:"uint8",xlen:"uint16"},subheader:{si1:"uint8",si2:"uint8",slen:"uint16",bsize:"uint16"},bgzfHd:{head:"header",subhead:"subheader"}},hdSize=18;EOFblk=new Uint8Array([31,139,8,4,0,0,0,0,0,255,6,0,66,67,2,0,27,0,3,0,0,0,0,0,0,0,0,0]),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.pako=t()}}(function(){return function t(e,a,n){function r(s,h){if(!a[s]){if(!e[s]){var l="function"==typeof require&&require;if(!h&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var o=a[s]={exports:{}};e[s][0].call(o.exports,function(t){var a=e[s][1][t];return r(a?a:t)},o,o.exports,t,e,a,n)}return a[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,a){"use strict";function n(t,e){var a=new b(e);if(a.push(t,!0),a.err)throw a.msg;return a.result}function r(t,e){return e=e||{},e.raw=!0,n(t,e)}function i(t,e){return e=e||{},e.gzip=!0,n(t,e)}var s=t("./zlib/deflate.js"),h=t("./utils/common"),l=t("./utils/strings"),o=t("./zlib/messages"),_=t("./zlib/zstream"),d=0,u=4,f=0,c=1,g=-1,p=0,m=8,b=function(t){this.options=h.assign({level:g,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var a=s.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(a!==f)throw new Error(o[a]);e.header&&s.deflateSetHeader(this.strm,e.header)};b.prototype.push=function(t,e){var a,n,r=this.strm,i=this.options.chunkSize;if(this.ended)return!1;n=e===~~e?e:e===!0?u:d,r.input="string"==typeof t?l.string2buf(t):t,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new h.Buf8(i),r.next_out=0,r.avail_out=i),a=s.deflate(r,n),a!==c&&a!==f)return this.onEnd(a),this.ended=!0,!1;(0===r.avail_out||0===r.avail_in&&n===u)&&this.onData("string"===this.options.to?l.buf2binstring(h.shrinkBuf(r.output,r.next_out)):h.shrinkBuf(r.output,r.next_out))}while((r.avail_in>0||0===r.avail_out)&&a!==c);return n===u?(a=s.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===f):!0},b.prototype.onData=function(t){this.chunks.push(t)},b.prototype.onEnd=function(t){t===f&&(this.result="string"===this.options.to?this.chunks.join(""):h.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},a.Deflate=b,a.deflate=n,a.deflateRaw=r,a.gzip=i},{"./utils/common":2,"./utils/strings":3,"./zlib/deflate.js":6,"./zlib/messages":7,"./zlib/zstream":9}],2:[function(t,e,a){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;a.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var a=e.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(var n in a)a.hasOwnProperty(n)&&(t[n]=a[n])}}return t},a.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,a,n,r){if(e.subarray&&t.subarray)return void t.set(e.subarray(a,a+n),r);for(var i=0;n>i;i++)t[r+i]=e[a+i]},flattenChunks:function(t){var e,a,n,r,i,s;for(n=0,e=0,a=t.length;a>e;e++)n+=t[e].length;for(s=new Uint8Array(n),r=0,e=0,a=t.length;a>e;e++)i=t[e],s.set(i,r),r+=i.length;return s}},i={arraySet:function(t,e,a,n,r){for(var i=0;n>i;i++)t[r+i]=e[a+i]},flattenChunks:function(t){return[].concat.apply([],t)}};a.setTyped=function(t){t?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,r)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,i))},a.setTyped(n)},{}],3:[function(t,e,a){"use strict";function n(t,e){if(65537>e&&(t.subarray&&s||!t.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var a="",n=0;e>n;n++)a+=String.fromCharCode(t[n]);return a}var r=t("./common"),i=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(h){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){s=!1}for(var l=new r.Buf8(256),o=0;256>o;o++)l[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;l[254]=l[254]=1,a.string2buf=function(t){var e,a,n,i,s,h=t.length,l=0;for(i=0;h>i;i++)a=t.charCodeAt(i),55296===(64512&a)&&h>i+1&&(n=t.charCodeAt(i+1),56320===(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),i++)),l+=128>a?1:2048>a?2:65536>a?3:4;for(e=new r.Buf8(l),s=0,i=0;l>s;i++)a=t.charCodeAt(i),55296===(64512&a)&&h>i+1&&(n=t.charCodeAt(i+1),56320===(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),i++)),128>a?e[s++]=a:2048>a?(e[s++]=192|a>>>6,e[s++]=128|63&a):65536>a?(e[s++]=224|a>>>12,e[s++]=128|a>>>6&63,e[s++]=128|63&a):(e[s++]=240|a>>>18,e[s++]=128|a>>>12&63,e[s++]=128|a>>>6&63,e[s++]=128|63&a);return e},a.buf2binstring=function(t){return n(t,t.length)},a.binstring2buf=function(t){for(var e=new r.Buf8(t.length),a=0,n=e.length;n>a;a++)e[a]=t.charCodeAt(a);return e},a.buf2string=function(t,e){var a,r,i,s,h=e||t.length,o=new Array(2*h);for(r=0,a=0;h>a;)if(i=t[a++],128>i)o[r++]=i;else if(s=l[i],s>4)o[r++]=65533,a+=s-1;else{for(i&=2===s?31:3===s?15:7;s>1&&h>a;)i=i<<6|63&t[a++],s--;s>1?o[r++]=65533:65536>i?o[r++]=i:(i-=65536,o[r++]=55296|i>>10&1023,o[r++]=56320|1023&i)}return n(o,r)},a.utf8border=function(t,e){var a;for(e=e||t.length,e>t.length&&(e=t.length),a=e-1;a>=0&&128===(192&t[a]);)a--;return 0>a?e:0===a?e:a+l[t[a]]>e?a:e}},{"./common":2}],4:[function(t,e){"use strict";function a(t,e,a,n){for(var r=65535&t|0,i=t>>>16&65535|0,s=0;0!==a;){s=a>2e3?2e3:a,a-=s;do r=r+e[n++]|0,i=i+r|0;while(--s);r%=65521,i%=65521}return r|i<<16|0}e.exports=a},{}],5:[function(t,e){"use strict";function a(){for(var t,e=[],a=0;256>a;a++){t=a;for(var n=0;8>n;n++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e}function n(t,e,a,n){var i=r,s=n+a;t=-1^t;for(var h=n;s>h;h++)t=t>>>8^i[255&(t^e[h])];return-1^t}var r=a();e.exports=n},{}],6:[function(t,e,a){"use strict";function n(t,e){return t.msg=U[e],e}function r(t){return(t<<1)-(t>4?9:0)}function i(t){for(var e=t.length;--e>=0;)t[e]=0}function s(t){var e=t.state,a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(S.arraySet(t.output,e.pending_buf,e.pending_out,a,t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))}function h(t,e){E._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,s(t.strm)}function l(t,e){t.pending_buf[t.pending++]=e}function o(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function _(t,e,a,n){var r=t.avail_in;return r>n&&(r=n),0===r?0:(t.avail_in-=r,S.arraySet(e,t.input,t.next_in,r,a),1===t.state.wrap?t.adler=j(t.adler,e,r,a):2===t.state.wrap&&(t.adler=I(t.adler,e,r,a)),t.next_in+=r,t.total_in+=r,r)}function d(t,e){var a,n,r=t.max_chain_length,i=t.strstart,s=t.prev_length,h=t.nice_match,l=t.strstart>t.w_size-oe?t.strstart-(t.w_size-oe):0,o=t.window,_=t.w_mask,d=t.prev,u=t.strstart+le,f=o[i+s-1],c=o[i+s];t.prev_length>=t.good_match&&(r>>=2),h>t.lookahead&&(h=t.lookahead);do if(a=e,o[a+s]===c&&o[a+s-1]===f&&o[a]===o[i]&&o[++a]===o[i+1]){i+=2,a++;do;while(o[++i]===o[++a]&&o[++i]===o[++a]&&o[++i]===o[++a]&&o[++i]===o[++a]&&o[++i]===o[++a]&&o[++i]===o[++a]&&o[++i]===o[++a]&&o[++i]===o[++a]&&u>i);if(n=le-(u-i),i=u-le,n>s){if(t.match_start=e,s=n,n>=h)break;f=o[i+s-1],c=o[i+s]}}while((e=d[e&_])>l&&0!==--r);return s<=t.lookahead?s:t.lookahead}function u(t){var e,a,n,r,i,s=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-oe)){S.arraySet(t.window,t.window,s,s,0),t.match_start-=s,t.strstart-=s,t.block_start-=s,a=t.hash_size,e=a;do n=t.head[--e],t.head[e]=n>=s?n-s:0;while(--a);a=s,e=a;do n=t.prev[--e],t.prev[e]=n>=s?n-s:0;while(--a);r+=s}if(0===t.strm.avail_in)break;if(a=_(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=a,t.lookahead+t.insert>=he)for(i=t.strstart-t.insert,t.ins_h=t.window[i],t.ins_h=(t.ins_h<<t.hash_shift^t.window[i+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[i+he-1])&t.hash_mask,t.prev[i&t.w_mask]=t.head[t.ins_h],
t.head[t.ins_h]=i,i++,t.insert--,!(t.lookahead+t.insert<he)););}while(t.lookahead<oe&&0!==t.strm.avail_in)}function f(t,e){var a=65535;for(a>t.pending_buf_size-5&&(a=t.pending_buf_size-5);;){if(t.lookahead<=1){if(u(t),0===t.lookahead&&e===q)return be;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+a;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,h(t,!1),0===t.strm.avail_out))return be;if(t.strstart-t.block_start>=t.w_size-oe&&(h(t,!1),0===t.strm.avail_out))return be}return t.insert=0,e===T?(h(t,!0),0===t.strm.avail_out?we:ye):t.strstart>t.block_start&&(h(t,!1),0===t.strm.avail_out)?be:be}function c(t,e){for(var a,n;;){if(t.lookahead<oe){if(u(t),t.lookahead<oe&&e===q)return be;if(0===t.lookahead)break}if(a=0,t.lookahead>=he&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+he-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-oe&&(t.match_length=d(t,a)),t.match_length>=he)if(n=E._tr_tally(t,t.strstart-t.match_start,t.match_length-he),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=he){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+he-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=E._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(h(t,!1),0===t.strm.avail_out))return be}return t.insert=t.strstart<he-1?t.strstart:he-1,e===T?(h(t,!0),0===t.strm.avail_out?we:ye):t.last_lit&&(h(t,!1),0===t.strm.avail_out)?be:ve}function g(t,e){for(var a,n,r;;){if(t.lookahead<oe){if(u(t),t.lookahead<oe&&e===q)return be;if(0===t.lookahead)break}if(a=0,t.lookahead>=he&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+he-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=he-1,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-oe&&(t.match_length=d(t,a),t.match_length<=5&&(t.strategy===G||t.match_length===he&&t.strstart-t.match_start>4096)&&(t.match_length=he-1)),t.prev_length>=he&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-he,n=E._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-he),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+he-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(0!==--t.prev_length);if(t.match_available=0,t.match_length=he-1,t.strstart++,n&&(h(t,!1),0===t.strm.avail_out))return be}else if(t.match_available){if(n=E._tr_tally(t,0,t.window[t.strstart-1]),n&&h(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return be}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=E._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<he-1?t.strstart:he-1,e===T?(h(t,!0),0===t.strm.avail_out?we:ye):t.last_lit&&(h(t,!1),0===t.strm.avail_out)?be:ve}function p(t,e){for(var a,n,r,i,s=t.window;;){if(t.lookahead<=le){if(u(t),t.lookahead<=le&&e===q)return be;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=he&&t.strstart>0&&(r=t.strstart-1,n=s[r],n===s[++r]&&n===s[++r]&&n===s[++r])){i=t.strstart+le;do;while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&i>r);t.match_length=le-(i-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=he?(a=E._tr_tally(t,1,t.match_length-he),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=E._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(h(t,!1),0===t.strm.avail_out))return be}return t.insert=0,e===T?(h(t,!0),0===t.strm.avail_out?we:ye):t.last_lit&&(h(t,!1),0===t.strm.avail_out)?be:ve}function m(t,e){for(var a;;){if(0===t.lookahead&&(u(t),0===t.lookahead)){if(e===q)return be;break}if(t.match_length=0,a=E._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(h(t,!1),0===t.strm.avail_out))return be}return t.insert=0,e===T?(h(t,!0),0===t.strm.avail_out?we:ye):t.last_lit&&(h(t,!1),0===t.strm.avail_out)?be:ve}function b(t){t.window_size=2*t.w_size,i(t.head),t.max_lazy_match=C[t.level].max_lazy,t.good_match=C[t.level].good_length,t.nice_match=C[t.level].nice_length,t.max_chain_length=C[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=he-1,t.match_available=0,t.ins_h=0}function v(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=X,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new S.Buf16(2*ie),this.dyn_dtree=new S.Buf16(2*(2*ne+1)),this.bl_tree=new S.Buf16(2*(2*re+1)),i(this.dyn_ltree),i(this.dyn_dtree),i(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new S.Buf16(se+1),this.heap=new S.Buf16(2*ae+1),i(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new S.Buf16(2*ae+1),i(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function w(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=W,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?de:pe,t.adler=2===e.wrap?0:1,e.last_flush=q,E._tr_init(e),L):n(t,N)}function y(t){var e=w(t);return e===L&&b(t.state),e}function z(t,e){return t&&t.state?2!==t.state.wrap?N:(t.state.gzhead=e,L):N}function k(t,e,a,r,i,s){if(!t)return N;var h=1;if(e===F&&(e=6),0>r?(h=0,r=-r):r>15&&(h=2,r-=16),1>i||i>Y||a!==X||8>r||r>15||0>e||e>9||0>s||s>Q)return n(t,N);8===r&&(r=9);var l=new v;return t.state=l,l.strm=t,l.wrap=h,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+he-1)/he),l.window=new S.Buf8(2*l.w_size),l.head=new S.Buf16(l.hash_size),l.prev=new S.Buf16(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new S.Buf8(l.pending_buf_size),l.d_buf=l.lit_bufsize>>1,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=s,l.method=a,y(t)}function x(t,e){return k(t,e,X,Z,$,V)}function B(t,e){var a,h,_,d;if(!t||!t.state||e>H||0>e)return t?n(t,N):N;if(h=t.state,!t.output||!t.input&&0!==t.avail_in||h.status===me&&e!==T)return n(t,0===t.avail_out?P:N);if(h.strm=t,a=h.last_flush,h.last_flush=e,h.status===de)if(2===h.wrap)t.adler=0,l(h,31),l(h,139),l(h,8),h.gzhead?(l(h,(h.gzhead.text?1:0)+(h.gzhead.hcrc?2:0)+(h.gzhead.extra?4:0)+(h.gzhead.name?8:0)+(h.gzhead.comment?16:0)),l(h,255&h.gzhead.time),l(h,h.gzhead.time>>8&255),l(h,h.gzhead.time>>16&255),l(h,h.gzhead.time>>24&255),l(h,9===h.level?2:h.strategy>=J||h.level<2?4:0),l(h,255&h.gzhead.os),h.gzhead.extra&&h.gzhead.extra.length&&(l(h,255&h.gzhead.extra.length),l(h,h.gzhead.extra.length>>8&255)),h.gzhead.hcrc&&(t.adler=I(t.adler,h.pending_buf,h.pending,0)),h.gzindex=0,h.status=ue):(l(h,0),l(h,0),l(h,0),l(h,0),l(h,0),l(h,9===h.level?2:h.strategy>=J||h.level<2?4:0),l(h,ze),h.status=pe);else{var u=X+(h.w_bits-8<<4)<<8,f=-1;f=h.strategy>=J||h.level<2?0:h.level<6?1:6===h.level?2:3,u|=f<<6,0!==h.strstart&&(u|=_e),u+=31-u%31,h.status=pe,o(h,u),0!==h.strstart&&(o(h,t.adler>>>16),o(h,65535&t.adler)),t.adler=1}if(h.status===ue)if(h.gzhead.extra){for(_=h.pending;h.gzindex<(65535&h.gzhead.extra.length)&&(h.pending!==h.pending_buf_size||(h.gzhead.hcrc&&h.pending>_&&(t.adler=I(t.adler,h.pending_buf,h.pending-_,_)),s(t),_=h.pending,h.pending!==h.pending_buf_size));)l(h,255&h.gzhead.extra[h.gzindex]),h.gzindex++;h.gzhead.hcrc&&h.pending>_&&(t.adler=I(t.adler,h.pending_buf,h.pending-_,_)),h.gzindex===h.gzhead.extra.length&&(h.gzindex=0,h.status=fe)}else h.status=fe;if(h.status===fe)if(h.gzhead.name){_=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>_&&(t.adler=I(t.adler,h.pending_buf,h.pending-_,_)),s(t),_=h.pending,h.pending===h.pending_buf_size)){d=1;break}d=h.gzindex<h.gzhead.name.length?255&h.gzhead.name.charCodeAt(h.gzindex++):0,l(h,d)}while(0!==d);h.gzhead.hcrc&&h.pending>_&&(t.adler=I(t.adler,h.pending_buf,h.pending-_,_)),0===d&&(h.gzindex=0,h.status=ce)}else h.status=ce;if(h.status===ce)if(h.gzhead.comment){_=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>_&&(t.adler=I(t.adler,h.pending_buf,h.pending-_,_)),s(t),_=h.pending,h.pending===h.pending_buf_size)){d=1;break}d=h.gzindex<h.gzhead.comment.length?255&h.gzhead.comment.charCodeAt(h.gzindex++):0,l(h,d)}while(0!==d);h.gzhead.hcrc&&h.pending>_&&(t.adler=I(t.adler,h.pending_buf,h.pending-_,_)),0===d&&(h.status=ge)}else h.status=ge;if(h.status===ge&&(h.gzhead.hcrc?(h.pending+2>h.pending_buf_size&&s(t),h.pending+2<=h.pending_buf_size&&(l(h,255&t.adler),l(h,t.adler>>8&255),t.adler=0,h.status=pe)):h.status=pe),0!==h.pending){if(s(t),0===t.avail_out)return h.last_flush=-1,L}else if(0===t.avail_in&&r(e)<=r(a)&&e!==T)return n(t,P);if(h.status===me&&0!==t.avail_in)return n(t,P);if(0!==t.avail_in||0!==h.lookahead||e!==q&&h.status!==me){var c=h.strategy===J?m(h,e):h.strategy===M?p(h,e):C[h.level].func(h,e);if((c===we||c===ye)&&(h.status=me),c===be||c===we)return 0===t.avail_out&&(h.last_flush=-1),L;if(c===ve&&(e===D?E._tr_align(h):e!==H&&(E._tr_stored_block(h,0,0,!1),e===R&&(i(h.head),0===h.lookahead&&(h.strstart=0,h.block_start=0,h.insert=0))),s(t),0===t.avail_out))return h.last_flush=-1,L}return e!==T?L:h.wrap<=0?K:(2===h.wrap?(l(h,255&t.adler),l(h,t.adler>>8&255),l(h,t.adler>>16&255),l(h,t.adler>>24&255),l(h,255&t.total_in),l(h,t.total_in>>8&255),l(h,t.total_in>>16&255),l(h,t.total_in>>24&255)):(o(h,t.adler>>>16),o(h,65535&t.adler)),s(t),h.wrap>0&&(h.wrap=-h.wrap),0!==h.pending?L:K)}function A(t){var e;return t&&t.state?(e=t.state.status,e!==de&&e!==ue&&e!==fe&&e!==ce&&e!==ge&&e!==pe&&e!==me?n(t,N):(t.state=null,e===pe?n(t,O):L)):N}var C,S=t("../utils/common"),E=t("./trees"),j=t("./adler32"),I=t("./crc32"),U=t("./messages"),q=0,D=1,R=3,T=4,H=5,L=0,K=1,N=-2,O=-3,P=-5,F=-1,G=1,J=2,M=3,Q=4,V=0,W=2,X=8,Y=9,Z=15,$=8,te=29,ee=256,ae=ee+1+te,ne=30,re=19,ie=2*ae+1,se=15,he=3,le=258,oe=le+he+1,_e=32,de=42,ue=69,fe=73,ce=91,ge=103,pe=113,me=666,be=1,ve=2,we=3,ye=4,ze=3,ke=function(t,e,a,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=n,this.func=r};C=[new ke(0,0,0,0,f),new ke(4,4,8,4,c),new ke(4,5,16,8,c),new ke(4,6,32,32,c),new ke(4,4,16,16,g),new ke(8,16,32,32,g),new ke(8,16,128,128,g),new ke(8,32,128,256,g),new ke(32,128,258,1024,g),new ke(32,258,258,4096,g)],a.deflateInit=x,a.deflateInit2=k,a.deflateReset=y,a.deflateResetKeep=w,a.deflateSetHeader=z,a.deflate=B,a.deflateEnd=A,a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":2,"./adler32":4,"./crc32":5,"./messages":7,"./trees":8}],7:[function(t,e){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],8:[function(t,e,a){"use strict";function n(t){for(var e=t.length;--e>=0;)t[e]=0}function r(t){return 256>t?se[t]:se[256+(t>>>7)]}function i(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function s(t,e,a){t.bi_valid>Q-a?(t.bi_buf|=e<<t.bi_valid&65535,i(t,t.bi_buf),t.bi_buf=e>>Q-t.bi_valid,t.bi_valid+=a-Q):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)}function h(t,e,a){s(t,a[2*e],a[2*e+1])}function l(t,e){var a=0;do a|=1&t,t>>>=1,a<<=1;while(--e>0);return a>>>1}function o(t){16===t.bi_valid?(i(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function _(t,e){var a,n,r,i,s,h,l=e.dyn_tree,o=e.max_code,_=e.stat_desc.static_tree,d=e.stat_desc.has_stree,u=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,c=e.stat_desc.max_length,g=0;for(i=0;M>=i;i++)t.bl_count[i]=0;for(l[2*t.heap[t.heap_max]+1]=0,a=t.heap_max+1;J>a;a++)n=t.heap[a],i=l[2*l[2*n+1]+1]+1,i>c&&(i=c,g++),l[2*n+1]=i,n>o||(t.bl_count[i]++,s=0,n>=f&&(s=u[n-f]),h=l[2*n],t.opt_len+=h*(i+s),d&&(t.static_len+=h*(_[2*n+1]+s)));if(0!==g){do{for(i=c-1;0===t.bl_count[i];)i--;t.bl_count[i]--,t.bl_count[i+1]+=2,t.bl_count[c]--,g-=2}while(g>0);for(i=c;0!==i;i--)for(n=t.bl_count[i];0!==n;)r=t.heap[--a],r>o||(l[2*r+1]!==i&&(t.opt_len+=(i-l[2*r+1])*l[2*r],l[2*r+1]=i),n--)}}function d(t,e,a){var n,r,i=new Array(M+1),s=0;for(n=1;M>=n;n++)i[n]=s=s+a[n-1]<<1;for(r=0;e>=r;r++){var h=t[2*r+1];0!==h&&(t[2*r]=l(i[h]++,h))}}function u(){var t,e,a,n,r,i=new Array(M+1);for(a=0,n=0;N-1>n;n++)for(le[n]=a,t=0;t<1<<$[n];t++)he[a++]=n;for(he[a-1]=n,r=0,n=0;16>n;n++)for(oe[n]=r,t=0;t<1<<te[n];t++)se[r++]=n;for(r>>=7;F>n;n++)for(oe[n]=r<<7,t=0;t<1<<te[n]-7;t++)se[256+r++]=n;for(e=0;M>=e;e++)i[e]=0;for(t=0;143>=t;)re[2*t+1]=8,t++,i[8]++;for(;255>=t;)re[2*t+1]=9,t++,i[9]++;for(;279>=t;)re[2*t+1]=7,t++,i[7]++;for(;287>=t;)re[2*t+1]=8,t++,i[8]++;for(d(re,P+1,i),t=0;F>t;t++)ie[2*t+1]=5,ie[2*t]=l(t,5);_e=new fe(re,$,O+1,P,M),de=new fe(ie,te,0,F,M),ue=new fe(new Array(0),ee,0,G,V)}function f(t){var e;for(e=0;P>e;e++)t.dyn_ltree[2*e]=0;for(e=0;F>e;e++)t.dyn_dtree[2*e]=0;for(e=0;G>e;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*W]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function c(t){t.bi_valid>8?i(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function g(t,e,a,n){c(t),n&&(i(t,a),i(t,~a)),j.arraySet(t.pending_buf,t.window,e,a,t.pending),t.pending+=a}function p(t,e,a,n){var r=2*e,i=2*a;return t[r]<t[i]||t[r]===t[i]&&n[e]<=n[a]}function m(t,e,a){for(var n=t.heap[a],r=a<<1;r<=t.heap_len&&(r<t.heap_len&&p(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!p(e,n,t.heap[r],t.depth));)t.heap[a]=t.heap[r],a=r,r<<=1;t.heap[a]=n}function b(t,e,a){var n,i,l,o,_=0;if(0!==t.last_lit)do n=t.pending_buf[t.d_buf+2*_]<<8|t.pending_buf[t.d_buf+2*_+1],i=t.pending_buf[t.l_buf+_],_++,0===n?h(t,i,e):(l=he[i],h(t,l+O+1,e),o=$[l],0!==o&&(i-=le[l],s(t,i,o)),n--,l=r(n),h(t,l,a),o=te[l],0!==o&&(n-=oe[l],s(t,n,o)));while(_<t.last_lit);h(t,W,e)}function v(t,e){var a,n,r,i=e.dyn_tree,s=e.stat_desc.static_tree,h=e.stat_desc.has_stree,l=e.stat_desc.elems,o=-1;for(t.heap_len=0,t.heap_max=J,a=0;l>a;a++)0!==i[2*a]?(t.heap[++t.heap_len]=o=a,t.depth[a]=0):i[2*a+1]=0;for(;t.heap_len<2;)r=t.heap[++t.heap_len]=2>o?++o:0,i[2*r]=1,t.depth[r]=0,t.opt_len--,h&&(t.static_len-=s[2*r+1]);for(e.max_code=o,a=t.heap_len>>1;a>=1;a--)m(t,i,a);r=l;do a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],m(t,i,1),n=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=n,i[2*r]=i[2*a]+i[2*n],t.depth[r]=(t.depth[a]>=t.depth[n]?t.depth[a]:t.depth[n])+1,i[2*a+1]=i[2*n+1]=r,t.heap[1]=r++,m(t,i,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],_(t,e),d(i,o,t.bl_count)}function w(t,e,a){var n,r,i=-1,s=e[1],h=0,l=7,o=4;for(0===s&&(l=138,o=3),e[2*(a+1)+1]=65535,n=0;a>=n;n++)r=s,s=e[2*(n+1)+1],++h<l&&r===s||(o>h?t.bl_tree[2*r]+=h:0!==r?(r!==i&&t.bl_tree[2*r]++,t.bl_tree[2*X]++):10>=h?t.bl_tree[2*Y]++:t.bl_tree[2*Z]++,h=0,i=r,0===s?(l=138,o=3):r===s?(l=6,o=3):(l=7,o=4))}function y(t,e,a){var n,r,i=-1,l=e[1],o=0,_=7,d=4;for(0===l&&(_=138,d=3),n=0;a>=n;n++)if(r=l,l=e[2*(n+1)+1],!(++o<_&&r===l)){if(d>o){do h(t,r,t.bl_tree);while(0!==--o)}else 0!==r?(r!==i&&(h(t,r,t.bl_tree),o--),h(t,X,t.bl_tree),s(t,o-3,2)):10>=o?(h(t,Y,t.bl_tree),s(t,o-3,3)):(h(t,Z,t.bl_tree),s(t,o-11,7));o=0,i=r,0===l?(_=138,d=3):r===l?(_=6,d=3):(_=7,d=4)}}function z(t){var e;for(w(t,t.dyn_ltree,t.l_desc.max_code),w(t,t.dyn_dtree,t.d_desc.max_code),v(t,t.bl_desc),e=G-1;e>=3&&0===t.bl_tree[2*ae[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function k(t,e,a,n){var r;for(s(t,e-257,5),s(t,a-1,5),s(t,n-4,4),r=0;n>r;r++)s(t,t.bl_tree[2*ae[r]+1],3);y(t,t.dyn_ltree,e-1),y(t,t.dyn_dtree,a-1)}function x(t){var e,a=4093624447;for(e=0;31>=e;e++,a>>>=1)if(1&a&&0!==t.dyn_ltree[2*e])return U;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return q;for(e=32;O>e;e++)if(0!==t.dyn_ltree[2*e])return q;return U}function B(t){ge||(u(),ge=!0),t.l_desc=new ce(t.dyn_ltree,_e),t.d_desc=new ce(t.dyn_dtree,de),t.bl_desc=new ce(t.bl_tree,ue),t.bi_buf=0,t.bi_valid=0,f(t)}function A(t,e,a,n){s(t,(R<<1)+(n?1:0),3),g(t,e,a,!0)}function C(t){s(t,T<<1,3),h(t,W,re),o(t)}function S(t,e,a,n){var r,i,h=0;t.level>0?(t.strm.data_type===D&&(t.strm.data_type=x(t)),v(t,t.l_desc),v(t,t.d_desc),h=z(t),r=t.opt_len+3+7>>>3,i=t.static_len+3+7>>>3,r>=i&&(r=i)):r=i=a+5,r>=a+4&&-1!==e?A(t,e,a,n):t.strategy===I||i===r?(s(t,(T<<1)+(n?1:0),3),b(t,re,ie)):(s(t,(H<<1)+(n?1:0),3),k(t,t.l_desc.max_code+1,t.d_desc.max_code+1,h+1),b(t,t.dyn_ltree,t.dyn_dtree)),f(t),n&&c(t)}function E(t,e,a){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&a,t.last_lit++,0===e?t.dyn_ltree[2*a]++:(t.matches++,e--,t.dyn_ltree[2*(he[a]+O+1)]++,t.dyn_dtree[2*r(e)]++),t.last_lit===t.lit_bufsize-1}var j=t("../utils/common"),I=4,U=0,q=1,D=2,R=0,T=1,H=2,L=3,K=258,N=29,O=256,P=O+1+N,F=30,G=19,J=2*P+1,M=15,Q=16,V=7,W=256,X=16,Y=17,Z=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],te=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=512,re=new Array(2*(P+2));n(re);var ie=new Array(2*F);n(ie);var se=new Array(ne);n(se);var he=new Array(K-L+1);n(he);var le=new Array(N);n(le);var oe=new Array(F);n(oe);var _e,de,ue,fe=function(t,e,a,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=n,this.max_length=r,this.has_stree=t&&t.length},ce=function(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e},ge=!1;a._tr_init=B,a._tr_stored_block=A,a._tr_flush_block=S,a._tr_tally=E,a._tr_align=C},{"../utils/common":2}],9:[function(t,e){"use strict";function a(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=a},{}]},{},[1])(1)});var bai_fmt={string0:function(size){return this.parse(["string",size]).replace(/\0+$/,"")},uint64:function(){return this.view.getUint64()},header:{magic:["string",4],n_ref:"int32"},chunk:{cnk_beg:"uint64",cnk_end:"uint64"},bin:{bin:"uint32",n_chunk:"int32",chunkseq:["array","chunk",function(){return this.current.n_chunk}]},index:{n_bin:"int32",binseq:["array","bin",function(){return this.current.n_bin}],n_intv:"int32",intervseq:["array","uint64",function(){return this.current.n_intv}]},bai:{head:"header",indexseq:["array","index",function(){return this.current.head.n_ref}]}},bam_fmt={string0:function(size){return this.parse(["string",size]).replace(/\0+$/,"")},ubarray:function(size){var x=this.parse(["array","uint8",size]);return new Uint8Array(x)},header:{magic:["string",4],l_text:"int32",text:["string0",function(){return this.current.l_text}],n_ref:"int32"},reference:{l_name:"int32",name:["string0",function(){return this.current.l_name}],l_ref:"int32"},uba_aln:{block_size:"int32",uba_aln_info:["ubarray",function(){return this.current.block_size}]},bam_front:{head:"header",refs:["array","reference",function(){return this.current.head.n_ref}]},alnUbas:function(){for(var aln_ubas=[];this.tell()<this.len;)aln_ubas.push(this.parse("uba_aln"));return aln_ubas},bam:{front:"bam_front",aln_ubas:"alnUbas"}},BAMintType2jParserType={A:"char",c:"int8",C:"uint8",s:"int16",S:"uint16",i:"int32",I:"uint32",f:"float32"},aln_fmt={string0:function(size){return this.parse(["string",size]).replace(/\0+$/,"")},header:{refID:"int32",pos:"int32",l_read_name:"uint8",mapq:"uint8",bin:"uint16",n_cigar_op:"uint16",flag:"uint16",l_seq:"int32",next_refID:"int32",next_pos:"int32",tlen:"int32",read_name:["string0",function(){return this.current.l_read_name}],cigar:["array","uint32",function(){return this.current.n_cigar_op}],seq:["array","uint8",function(){return Math.floor((this.current.l_seq+1)/2)}],qual:["string0",function(){return this.current.l_seq}]},aux_hd:{tag:["string0",2],val_type:"char"},Cstring:function(){var res=cstg(this.tell(),this.aln_buf);return this.seek(res[0]),res[1]},Barray:{val_type:"char",count:"int32",value:["array",function(){return BAMintType2jParserType[this.current.val_type]},function(){return this.current.count}]},aux:function(){var hd=this.parse("aux_hd");switch(hd.val_type){case"B":var B=this.parse("Barray");hd.value=B.value;break;case"H":hd.value=this.parse("Cstring");break;case"Z":hd.value=this.parse("Cstring");break;default:hd.value=this.parse(BAMintType2jParserType[hd.val_type])}return hd},auxs:function(){for(var aux_data=[];this.tell()<this.aln_end;)aux_data.push(this.parse("aux"));return aux_data},aln:{head:"header",aux_data:"auxs"}},files=void 0;readBaiFile.prototype.getIndex=function(cb){var cbfn=void 0!=cb?cb:function(x){console.log(x)},baiThis=this,f=this.theFile,bins2hash=function(binseq){var bhash={},i=0;for(var x in binseq){var b=binseq[x].bin;bhash[b]=i,i+=1}return bhash},parseBAI=function(reader){var resultBuffer=new Uint8Array(reader.result),parser=new jParser(resultBuffer,bai_fmt);baiThis.idxContent=parser.parse("bai");var n_ref=baiThis.idxContent.head.n_ref;for(baiThis.bhash={},i=0;i<n_ref;i++)baiThis.bhash[i]=bins2hash(baiThis.idxContent.indexseq[i].binseq);cbfn.call(baiThis,baiThis)},reader=new FileReader;reader.onloadend=function(evt){return evt.target.readyState==FileReader.DONE?parseBAI(reader):alert("Bad read for "+f+" status: "+evt.target.readyState)},reader.readAsArrayBuffer(f.slice(0,f.size))},readBaiFile.prototype.bin2Ranges=function(ref,binid){return bin2Ranges(this,ref,binid)},readBaiFile.prototype.bin2Beg=function(ref,binid){return bin2Beg(this,ref,binid)},readBaiFile.prototype.bin2End=function(ref,binid){return bin2End(thi,ref,binid)},readBaiFile.prototype.getChunks=function(ref,beg,end){return getChunks(this,ref,beg,end)},readBinaryBAM.prototype.bamFront=function(cb){var bamRthis=this;this.head?cb.call(this,this.head,this.refs):wrappedJParser(this.theFile,0,bam_fmt,function(bhp){bamRthis.bhp=bhp,bamRthis.head=bhp.head=bhp.parse("header"),getBamRefs(bhp,function(refs){bamRthis.refs=refs,bamRthis.refhash=simpleHash(refs,"name"),bamRthis.headUba=bgzf(bhp.curBuf.subarray(0,bhp.tell())),bamRthis.bamFront(cb)})})},readBinaryBAM.prototype.refName2Index=function(name){return this.refhash[name]},readBinaryBAM.prototype.refsWithReads=function(cb,runfront){if(bamRthis=this,bamRthis.refsWreads)return cb&&cb.call(bamRthis,bamRthis.refsWreads),bamRthis.refsWreads;if(bamRthis.refs){var rswr=bamRthis.baiR.idxContent.indexseq.reduce(function(V,x,i,_){return 0==x.n_bin&&0==x.n_intv||V.push([x,bamRthis.refs[i]]),V},[]);return bamRthis.refsWreads=rswr,cb&&cb.call(bamRthis,rswr),rswr}return runfront?void bamRthis.bamFront(function(hd,refs){bamRthis.refsWithReads(cb)}):void(cb&&cb.call(bamRthis,void 0))},readBinaryBAM.prototype.getAlnUbas=function(ref,beg,end,cbfn,binary){var ref="number"==typeof ref?ref:this.refName2Index(ref),bamRthis=this,baiR=this.baiR,cnks=baiR.getChunks(ref,beg,end),aln_ubas=[],fn1=function(ckbeg,ckend){var vfbeg=ckbeg[0],bobeg=ckbeg[1],vfend=ckend[0],boend=ckend[1];wrappedRegionJParser(bamRthis.theFile,vfbeg,vfend,bam_fmt,function(bap){if(bap.seek(bobeg),bap.len=bap.curBuf.byteLength-bap.endBlkSz+boend,bamRthis.bap=bap,ubaInfo=_getRegAlnUba(bap),ubaInfo.uba=bap.curBuf,aln_ubas.push(ubaInfo),cnks.length>0){var rng=cnks.shift();fn1(rng[0],rng[1])}else cbfn.call(bamRthis,aln_ubas)})};if(cnks.length>0){console.log("CNKS: ",cnks);var rng=cnks.shift();console.log("RNG: ",rng),fn1(rng[0],rng[1])}else cbfn.call(bamRthis,[])},readBinaryBAM.prototype.getAlns=function(ref,beg,end,cbfn,binary){var bamRthis=this;bamRthis.getAlnUbas(ref,beg,end,function(ubas){var alns=[];ubas.forEach(function(ubaInfo){if(binary)alns.push(ubaInfo);else{var aln_blksizes=ubaInfo.aln_blksizes,offset=ubaInfo.beg+4,p=new jParser(ubaInfo.uba,aln_fmt);p.aln_buf=ubaInfo.uba;for(var i=0;i<aln_blksizes.length;i++){p.seek(offset),p.aln_end=offset+aln_blksizes[i];var aln=p.parse("aln");aln.head.pos+=1,aln.head.cigarArr=bamRthis.cigarInfo(aln),aln.head.cigarStr=aln.head.cigarArr.map(function(c){return c.op_len+c.op}).join(),aln.head.seqStr=bamRthis.getSeq(aln);var s=aln.head.pos,e=s+aln.head.l_seq;(s>beg&&end>=s||e>beg&&end>=e)&&alns.push(aln),offset=p.tell()+4}}}),cbfn.call(bamRthis,alns)})},readBinaryBAM.prototype.region2BAM=function(regmap,cbfn){var bamRthis=this;bamRthis.getAlns(regmap.name,regmap.start,regmap.end,function(alninfos){console.log("Done");var bgzfBlks=getBgzfBlocks(coalesce65KBCnks(alnCnkUbas(alninfos)));cbfn.call(bamRthis,bgzfBlks)},!0)},readBinaryBAM.prototype.regions2BAM=function(refsNregions,cbfn){var bamRthis=this,refregmaps=refsNregions,reduce=function(regmap){bamRthis.region2BAM(regmap,function(bgzfBlks){cbfn.call(bamRthis,bgzfBlks),refregmaps.length>0?reduce(refregmaps.shift()):cbfn.call(bamRthis,void 0)})};refregmaps.length>0?reduce(refregmaps.shift()):cbfn.call(bamRthis,void 0)},readBinaryBAM.prototype.throttledRegions2BAM=function(refsNregions,cbfn){var bamRthis=this,refregmaps=refsNregions,contfn=function(regmap){regmap?bamRthis.region2BAM(regmap,function(bgzfBlks){cbfn.call(bamRthis,bgzfBlks,contfn,refregmaps.shift())}):cbfn.call(bamRthis,void 0)};contfn(refregmaps.shift())},readBinaryBAM.prototype.getChunks=function(ref,beg,end){var baiR=this.baiR;return baiR.getChunks(ref,beg,end)},readBinaryBAM.prototype.cigarInfo=function(aln){return _.map(aln.head.cigar,cigarInfo)},readBinaryBAM.prototype.getSeq=function(aln){return seq2aas(aln.head.seq)};
